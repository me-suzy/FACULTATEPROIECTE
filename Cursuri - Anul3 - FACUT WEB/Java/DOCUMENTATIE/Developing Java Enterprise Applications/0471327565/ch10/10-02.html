
<SCRIPT>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
	',height=' + height + ',resizable=1,scrollbars=yes');
	}
	//-->
	</SCRIPT>



<FONT FACE="Arial,Helvetica" SIZE="-1">
To access the contents, click the chapter and section titles.
</FONT>
<P>
<B>Developing Java Enterprise Applications</B>
<FONT SIZE="-1">
<BR>
<I>(Publisher: John Wiley & Sons, Inc.)</I>
<BR>
Author(s): Stephen Asbury ; Scott R. Weiner
<BR>
ISBN: 0471327565
<BR>
Publication Date: 02/01/99
</FONT>
<P>
<Script language="JavaScript">
function isIE4() 
{
    return( navigator.appName.indexOf("Microsoft") != -1 && (navigator.appVersion.charAt(0)=='4') );
 }
function bookMarkit()
{
        var url="http://www.itknowledge.com/PSUser/EWBookMarks.html?url="+window.location+"&isbn=0";
	parent.location.href=url;
        //var win = window.open(url,"myitk");
        //if(!isIE4())
        //       win.focus();

}
</Script>
<a href="javascript:bookMarkit();"><img src="/images/bookmarkit.gif" border=0 alt="Bookmark It" width=97 height=23></a>

<P>
<form name="Search" method="GET" action="http://search.earthweb.com/search97/search_redir.cgi">

<INPUT TYPE="hidden" NAME="Action" VALUE="Search">
<INPUT TYPE="hidden" NAME="SearchPage" VALUE="http://search.earthweb.com/search97/samples/forms/srchdemo.htm">
<INPUT TYPE="hidden" NAME="Collection" VALUE="ITK">
<INPUT TYPE="hidden" NAME="ResultTemplate" VALUE="itk-simple-intrabook.hts">
<INPUT TYPE="hidden" NAME="ViewTemplate" VALUE="view.hts">

<font face="arial, helvetica" size=2><b>Search this book:</b></font><br>
<INPUT NAME="queryText" size=50 VALUE="">&nbsp;<input type="submit" name="submitbutton" value="Go!">
<INPUT type=hidden NAME="section_on" VALUE="on">
<INPUT type=hidden NAME="section" VALUE="http://www.itknowledge.com/reference/standard/0471327565/">

</form>


<!-- Empty Reference Subhead -->

<!--ISBN=0471327565//-->
<!--TITLE=Developing Java Enterprise Applications//-->
<!--AUTHOR=Stephen Asbury//-->
<!--AUTHOR=Scott R. Weiner//-->
<!--PUBLISHER=Wiley Computer Publishing//-->
<!--CHAPTER=10//-->
<!--PAGES=255-258//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="10-01.html">Previous</A></TD>
<TD><A HREF="../ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="10-03.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<P><BR></P>
<TABLE WIDTH="100%">
<TD CAPTION ALIGN="LEFT" COLSPAN="2"><B>Table 10.1</B> PageCompileServlet Configuration Parameters
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TH ALIGN="LEFT" VALIGN="TOP">PROPERTY
<TH ALIGN="LEFT" VALIGN="TOP">DESCRIPTION
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>workingDir</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">The directory for storing generated .java and .class files. By default, the workingDir is set to <I>javaServerInstallDir/</I> pagecompile/.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>defaultEncoding</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">Defines the default encoding to use for servlets. Any encoding name that is supported by the java.io package is a valid encoding string value for this property. The default value of null causes PageCompileServlet to treat the file as an array of bytes.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>verbose</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">If true, prints a message when compiling a .jhtml file. The default value is false.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>pageCheckSeconds</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">The number of seconds to wait before checking a .jhtml file for any changes occurring after initial compilation. The default value of 0 tells the servlet to always check for modifications.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>defaultPageClassName</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">The name of the class to use as a base class for pages that do not explicitly specify it. The default value is set to HttpServlet.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>packagePrefix</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">The package name to prepend onto the name of the generated class. The default value is set to pagecompile. 
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>compileCommand</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">The command for compiling the JSP servlets. The default value is javac -d <I>buildDirectory sourceFile</I>. When executed, the value of the workingDir property is substituted for the string buildDirectory, and the absolute path of the source file is substituted for the string sourceFile.
<TR>
<TD COLSPAN="2"><HR>
</TABLE>
<P>On the down side, JSP is intended to represent Web pages. It is not intended for responding to requests from applets, managing redirects, or even providing a mechanism for creating dynamic images. Rather, JSP creates dynamic Web pages, no more, no less. These pages are designed to make servlet writing easier in a situation in which the servlet is generating HTML and most of that HTML is static&#151;or at least the dynamic HTML is in the context of a static page design.
</P>
<P>An important point should be included in this discussion: Don&#146;t make every HTML page a JSP. This technology is designed for dynamically changing pages, pages that look different for every or almost every request. Normal HTML should still be defined in HTML files and returned directly by the Web server.</P>
<H3><A NAME="Heading5"></A><FONT COLOR="#000077">Basic Java in a JSP</FONT></H3>
<P>The first example of a JSP didn&#146;t include Java embedded in the HTML in order to show you the most basic servlet generation. The next example includes Java in our JSP by using the &ltjava&gt and &lt/java&gt tags. These tags can contain the attributes defined in Table 10.2. For the purpose of this example, use the &ltjava&gt tag without attributes or with the single attribute type=code. Because &ltjava type=code&gt is the same as &ltjava&gt, the type=code attribute will often be left out for clarity. This form of the java tag tells the PageCompileServlet to include code from the JHTML file into the servlet generated for it.
</P>
<P>The Java code inside the &ltjava&gt tags will be included in the server page&#146;s servlet as is. For example, if a simple update to our Hello World page is performed as follows:</P>
<TABLE WIDTH="100%"><TD CAPTION VALIGN="TOP" ALIGN=LEFT" COLSPAN="2"><B>Table 10.2</B> Java Tag Attributes
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TH ALIGN="LEFT" VALIGN="TOP">ATTRIBUTE
<TH ALIGN="LEFT" VALIGN="TOP">PURPOSE
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT">&ltjava type=code&gt&lt/java&gt
<TD VALIGN="TOP" ALIGN="LEFT">Performs the same function as &ltjava&gt&lt/java&gt.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT">&ltjava type=import&gt&lt/java&gt
<TD VALIGN="TOP" ALIGN="LEFT">Defines the name of a class to import.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT">&ltjava type=extends&gt&lt/java&gt
<TD VALIGN="TOP" ALIGN="LEFT">Defines the name of a class from which to extend the servlet.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT">&ltjava type=print&gt&lt/java&gt
<TD VALIGN="TOP" ALIGN="LEFT">Defines an expression in Java to send to the output stream.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT">&ltjava type=implements&gt&lt/java&gt
<TD VALIGN="TOP" ALIGN="LEFT">Defines a list of interfaces the servlet must implement.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT">&ltjava type=class&gt&lt/java&gt
<TD VALIGN="TOP" ALIGN="LEFT">Describes member variables and defining methods of the page class directly.
<TR>
<TD COLSPAN="2"><HR>
</TABLE>
<!-- CODE //-->
<PRE>
&ltHTML&gt
&ltHEAD&gt
&ltTITLE&gt
Hello World
&lt/TITLE&gt
&lt/HEAD&gt
&ltBODY&gt
<B>&ltjava&gt
    out.println(&#147;&ltH1&gtHello Java World!&lt/H1&gt&#148;);
&lt/java&gt</B>
&lt/BODY&gt
&lt/HTML&gt
</PRE>
<!-- END CODE //-->
<P>and we have the PageCompileServlet compile our new dynamic JSP into a servlet, the result is code like this:
</P>
<!-- CODE //-->
<PRE>
package pagecompile;


import java.io.*;
import java.util.*;
import javax.servlet.*;
import javax.servlet.http.*;
import com.sun.server.webserver.pagecompile.filecache.*;
import com.sun.server.webserver.pagecompile.ParamsHttpServletRequest;
import com.sun.server.webserver.pagecompile.*;

public class _HelloWorld
extends HttpServlet{

//-------------------------------
  static {}
  
  //-------------- The service method
  public void service (HttpServletRequest request,
                         HttpServletResponse response)
      throws ServletException, IOException
  {
    <B>ServletOutputStream out = response.getOutputStream ();</B>
    ByteFileData __fileData = null;

    try
    {
      __fileData = (ByteFileData) ServletUtil.getJHtmlSource(this, 
      &#147;D:\\JAVA\\JWS1.1\\BIN\\..\\public_html\\HelloWorld.jhtml&#148;
      , null, 902608528000L);
      
      if (__fileData == null)
        throw new ServletException(&#147;FileChanged&#148;);

      /*** lines: 1-8 */
      __fileData.writeBytes (0, 58, out);

      <B>out.println(&#147;&ltH1&gtHello Java World!&lt/H1&gt&#148;);</B>

      /*** lines: 10-12 */      
      __fileData.writeBytes (116, 17, out);
    }
    finally
    {
      if (__fileData != null) __fileData.close();
    }
  }

}
</PRE>
<!-- END CODE //-->
<P>Notice that the regular HTML is still output directly from the file to the client, while the Java code is executed in place. This takes advantage of an aspect of the generated code in the server page. This is the automatic definition of the variable out, to represent the stream back to the client. This allows the JSP writer to return output easily, without dealing with the response object.
</P><P><BR></P>
<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="10-01.html">Previous</A></TD>
<TD><A HREF="../ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="10-03.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


<!-- 