
<SCRIPT>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
	',height=' + height + ',resizable=1,scrollbars=yes');
	}
	//-->
	</SCRIPT>



<FONT FACE="Arial,Helvetica" SIZE="-1">
To access the contents, click the chapter and section titles.
</FONT>
<P>
<B>Developing Java Enterprise Applications</B>
<FONT SIZE="-1">
<BR>
<I>(Publisher: John Wiley & Sons, Inc.)</I>
<BR>
Author(s): Stephen Asbury ; Scott R. Weiner
<BR>
ISBN: 0471327565
<BR>
Publication Date: 02/01/99
</FONT>
<P>
<Script language="JavaScript">
function isIE4() 
{
    return( navigator.appName.indexOf("Microsoft") != -1 && (navigator.appVersion.charAt(0)=='4') );
 }
function bookMarkit()
{
        var url="http://www.itknowledge.com/PSUser/EWBookMarks.html?url="+window.location+"&isbn=0";
	parent.location.href=url;
        //var win = window.open(url,"myitk");
        //if(!isIE4())
        //       win.focus();

}
</Script>
<a href="javascript:bookMarkit();"><img src="/images/bookmarkit.gif" border=0 alt="Bookmark It" width=97 height=23></a>

<P>
<form name="Search" method="GET" action="http://search.earthweb.com/search97/search_redir.cgi">

<INPUT TYPE="hidden" NAME="Action" VALUE="Search">
<INPUT TYPE="hidden" NAME="SearchPage" VALUE="http://search.earthweb.com/search97/samples/forms/srchdemo.htm">
<INPUT TYPE="hidden" NAME="Collection" VALUE="ITK">
<INPUT TYPE="hidden" NAME="ResultTemplate" VALUE="itk-simple-intrabook.hts">
<INPUT TYPE="hidden" NAME="ViewTemplate" VALUE="view.hts">

<font face="arial, helvetica" size=2><b>Search this book:</b></font><br>
<INPUT NAME="queryText" size=50 VALUE="">&nbsp;<input type="submit" name="submitbutton" value="Go!">
<INPUT type=hidden NAME="section_on" VALUE="on">
<INPUT type=hidden NAME="section" VALUE="http://www.itknowledge.com/reference/standard/0471327565/">

</form>


<!-- Empty Reference Subhead -->

<!--ISBN=0471327565//-->
<!--TITLE=Developing Java Enterprise Applications//-->
<!--AUTHOR=Stephen Asbury//-->
<!--AUTHOR=Scott R. Weiner//-->
<!--PUBLISHER=Wiley Computer Publishing//-->
<!--CHAPTER=10//-->
<!--PAGES=258-263//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="10-02.html">Previous</A></TD>
<TD><A HREF="../ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="10-04.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<P><BR></P>
<H4 ALIGN="LEFT"><A NAME="Heading6"></A><FONT COLOR="#000077">Scoping</FONT></H4>
<P>The straight &ltjava&gt tags indicate code that will be included verbatim in the generated service method. This means that variable definitions are scoped according to the code that surrounds them in the JSP, but they can exist beyond a single set of &ltjava&gt tags. As an example of how scoping works, three JSPs have been created here. The first page contains two sets of &ltjava&gt tags. The first set defines a variable name and prints it. The second set reassigns the name and prints it, showing what happens when you try to redeclare a variable. The third page shows what the servlet looks like when you define two Java code blocks. Here is the code for the first Web page.
</P>
<!-- CODE //-->
<PRE>
&ltHTML&gt
&ltHEAD&gt
&ltTITLE&gt
Try Reassign
&lt/TITLE&gt
&lt/HEAD&gt
&ltBODY&gt
&ltH2&gtJava Block One&lt/H2&gt
&ltjava&gt
    <B>String name = &#147;Mister Zero&#148;;
    out.println(name);</B>
&lt/java&gt
&ltH2&gtJava Block Two&lt/H2&gt
&ltjava&gt
    <B>name = &#147;Master Blaster&#148;;
    out.println(name);</B>
&lt/java&gt
&lt/BODY&gt
&lt/HTML&gt
</PRE>
<!-- END CODE //-->
<P>Notice the assignments in the boldfaced code in this HTML. The second set of tags doesn&#146;t need to redefine the variable, because it is already defined in the first set. The servlet code that follows was generated from this JSP. The reassignment code is in boldface type.
</P>
<!-- CODE //-->
<PRE>
package pagecompile;

import java.io.*;
import java.util.*;
import javax.servlet.*;
import javax.servlet.http.*;
import com.sun.server.webserver.pagecompile.filecache.*;
import com.sun.server.webserver.pagecompile.ParamsHttpServletRequest;
import com.sun.server.webserver.pagecompile.*;

public class _tryreassign
extends HttpServlet{

//-------------------------------
  static {
  }
  
  //-------------- The service method
  public void service (HttpServletRequest request,
                         HttpServletResponse response)
      throws ServletException, IOException
  {
    ServletOutputStream out = response.getOutputStream ();
    ByteFileData __fileData = null;
    
    try
    {
      __fileData = (ByteFileData) ServletUtil.getJHtmlSource(this, 
      &#147;D:\\JAVA\\JWS1.1\\BIN\\..\\public_html\\tryreassign.jhtml&#148;
      , null, 902610758000L);
      
      if (__fileData == null)
       throw new ServletException(&#147;FileChanged&#148;);

      /*** lines: 1-9 */
      __fileData.writeBytes (0, 83, out);

      <B>String name = &#147;Mister Zero&#148;;
      out.println(name);</B>

      /*** lines: 12-14 */
      __fileData.writeBytes (147, 25, out);

      <B>name = &#147;Master Blaster&#148;;
      out.println(name);</B>
      
      /*** lines: 17-19 */
      __fileData.writeBytes (232, 17, out);
    }
    finally
    {
      if (__fileData != null) __fileData.close();
    }
  }

}
</PRE>
<!-- END CODE //-->
<P>The separate &ltjava&gt blocks are combined into the single service method with only a single line of code between them writing out the HTML that separated the &lt/java&gt and &ltjava&gt tags that end and begin the two blocks.
</P>
<P>This means that the HTML code in the following page will not work, because it tries to redefine a variable in a scope that already defines it.</P>
<!-- CODE //-->
<PRE>
&ltHTML&gt
&ltHEAD&gt
&ltTITLE&gt
Try Redeclare
&lt/TITLE&gt
&lt/HEAD&gt
&ltBODY&gt
&ltH2&gtJava Block One&lt/H2&gt
&ltjava&gt
    <B>String name = &#147;Mister Zero&#148;;
    out.println(name);</B>
&lt/java&gt
&ltH2&gtJava Block Two&lt/H2&gt
&ltjava&gt
    <B>String name = &#147;Master Blaster&#148;;
    out.println(name);</B>
&lt/java&gt
&lt/BODY&gt

&lt/HTML&gt
</PRE>
<!-- END CODE //-->
<P>This page will not compile because of the redefinition of the name variable. Instead, the client is sent a message indicating the error, as pictured in Figure 10.3.
</P>
<P><A NAME="Fig3"></A><A HREF="javascript:displayWindow('images/10-03.jpg',946,391 )"><IMG SRC="images/10-03t.jpg"></A>
<BR><A HREF="javascript:displayWindow('images/10-03.jpg',946,391)"><FONT COLOR="#000077"><B>Figure 10.3</B></FONT></A>&nbsp;&nbsp;Attempt to redefine error page.</P>
<P>If you want the &ltjava&gt blocks to have separate scopes in the resulting servlet code, use curly brackets to delimit them, as in the following file:
</P>
<!-- CODE //-->
<PRE>
&ltHTML&gt
&ltHEAD&gt
&ltTITLE&gt
Two Code Blocks
&lt/TITLE&gt
&lt/HEAD&gt
&ltBODY&gt
&ltH2&gtJava Block One&lt/H2&gt
<B>&ltjava&gt
{
    String name = &#147;Mister Zero&#148;;
    out.println(name);
}
&lt/java&gt</B>
&ltH2&gtJava Block Two&lt/H2&gt
<B>&ltjava&gt
{
    String name = &#147;Master Blaster&#148;;
    out.println(name);
}
&lt/java&gt</B>
&lt/BODY&gt
&lt/HTML&gt
</PRE>
<!-- END CODE //-->
<P>This file results in the code:
</P>
<!-- CODE //-->
<PRE>
package pagecompile;

import java.io.*;
import java.util.*;
import javax.servlet.*;
import javax.servlet.http.*;
import com.sun.server.webserver.pagecompile.filecache.*;
import com.sun.server.webserver.pagecompile.ParamsHttpServletRequest;
import com.sun.server.webserver.pagecompile.*;

public class _twocodeblocks extends HttpServlet
{

//-------------------------------
  static {}
  
  //-------------- The service method
  public void service (HttpServletRequest request,
                         HttpServletResponse response)
      throws ServletException, IOException
  {
    ServletOutputStream out = response.getOutputStream ();
    ByteFileData __fileData = null;
    
    try
    {
      __fileData = (ByteFileData) ServletUtil.getJHtmlSource(this, 
      &#147;D:\\JAVA\\JWS1.1\\BIN\\..\\public_html\\twocodeblocks.jhtml&#148;
      , null, 902611208000L);
      
      if (__fileData == null)
        throw new ServletException(&#147;FileChanged&#148;);

      /*** lines: 1-9 */
      __fileData.writeBytes (0, 86, out);

      <B>{
        String name = &#147;Mister Zero&#148;;
        out.println(name);
      }</B>
     
     /*** lines: 14-16 */
      __fileData.writeBytes (154, 25, out);

      <B>{
        String name = &#147;Master Blaster&#148;;
        out.println(name);
      }</B>
      
      /*** lines: 21-23 */
      __fileData.writeBytes (250, 17, out);
    }
    finally
    {
      if (__fileData != null) __fileData.close();
    }
  }
}
</PRE>
<!-- END CODE //-->
<P>which creates separate blocks for each variable and compiles appropriately.
</P>
<H4 ALIGN="LEFT"><A NAME="Heading7"></A><FONT COLOR="#000077">Conditionals and Looping</FONT></H4>
<P>Keeping in mind the simple inclusion mechanism used to create the Java code for a JSP, loops and conditionals can be created as well. In this case, the code block for the if portion of a conditional can begin in one &ltjava&gt block and conclude in another. By combining these &ltjava&gt tags and curly brackets indicating Java blocks, conditional HTML can be created, as in the following example. This example sets a variable called test and displays the string &#147;True&#148; if test is true, or it displays &#147;False&#148; if test is false.
</P>
<!-- CODE //-->
<PRE>
&ltHTML&gt
&ltHEAD&gt
&ltTITLE&gt
Conditional HTML
&lt/TITLE&gt
&lt/HEAD&gt
&ltBODY&gt
&ltH2&gtSetting Value to False&lt/H2&gt
<B>&ltjava&gt
    boolean test = false;
&lt/java&gt</B>
&ltH2&gtThe value is:
<B>&ltjava&gt
if(test)
{
&lt/java&gt</B>
True
<B>&ltjava&gt
}
else
{
&lt/java&gt</B>
False
<B>&ltjava&gt
}
&lt/java&gt</B>
&lt/H2&gt
&lt/BODY&gt
&lt/HTML&gt
</PRE>
<!-- END CODE //-->
<P><BR></P>
<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="10-02.html">Previous</A></TD>
<TD><A HREF="../ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="10-04.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


<!-- 