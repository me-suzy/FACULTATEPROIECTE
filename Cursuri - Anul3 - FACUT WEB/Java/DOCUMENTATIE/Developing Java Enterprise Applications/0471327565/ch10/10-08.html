
<SCRIPT>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
	',height=' + height + ',resizable=1,scrollbars=yes');
	}
	//-->
	</SCRIPT>



<FONT FACE="Arial,Helvetica" SIZE="-1">
To access the contents, click the chapter and section titles.
</FONT>
<P>
<B>Developing Java Enterprise Applications</B>
<FONT SIZE="-1">
<BR>
<I>(Publisher: John Wiley & Sons, Inc.)</I>
<BR>
Author(s): Stephen Asbury ; Scott R. Weiner
<BR>
ISBN: 0471327565
<BR>
Publication Date: 02/01/99
</FONT>
<P>
<Script language="JavaScript">
function isIE4() 
{
    return( navigator.appName.indexOf("Microsoft") != -1 && (navigator.appVersion.charAt(0)=='4') );
 }
function bookMarkit()
{
        var url="http://www.itknowledge.com/PSUser/EWBookMarks.html?url="+window.location+"&isbn=0";
	parent.location.href=url;
        //var win = window.open(url,"myitk");
        //if(!isIE4())
        //       win.focus();

}
</Script>
<a href="javascript:bookMarkit();"><img src="/images/bookmarkit.gif" border=0 alt="Bookmark It" width=97 height=23></a>

<P>
<form name="Search" method="GET" action="http://search.earthweb.com/search97/search_redir.cgi">

<INPUT TYPE="hidden" NAME="Action" VALUE="Search">
<INPUT TYPE="hidden" NAME="SearchPage" VALUE="http://search.earthweb.com/search97/samples/forms/srchdemo.htm">
<INPUT TYPE="hidden" NAME="Collection" VALUE="ITK">
<INPUT TYPE="hidden" NAME="ResultTemplate" VALUE="itk-simple-intrabook.hts">
<INPUT TYPE="hidden" NAME="ViewTemplate" VALUE="view.hts">

<font face="arial, helvetica" size=2><b>Search this book:</b></font><br>
<INPUT NAME="queryText" size=50 VALUE="">&nbsp;<input type="submit" name="submitbutton" value="Go!">
<INPUT type=hidden NAME="section_on" VALUE="on">
<INPUT type=hidden NAME="section" VALUE="http://www.itknowledge.com/reference/standard/0471327565/">

</form>


<!-- Empty Reference Subhead -->

<!--ISBN=0471327565//-->
<!--TITLE=Developing Java Enterprise Applications//-->
<!--AUTHOR=Stephen Asbury//-->
<!--AUTHOR=Scott R. Weiner//-->
<!--PUBLISHER=Wiley Computer Publishing//-->
<!--CHAPTER=10//-->
<!--PAGES=283-287//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="10-07.html">Previous</A></TD>
<TD><A HREF="../ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="../ch11/11-01.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<P><BR></P>
<P>There are also special forms of the JSP tag, as there were attributes for the &ltjava&gt tag. The first form of the JSP tag is the configuration form. These configuration tags can contain attributes that take the form &lt%@ {variable = &#147; &lt value &gt&#148;}&#43; %&gt. The variables include:
</P>
<P><B>language</B>. Defines the scripting language used in the file. Java is the only value that <I>language</I> can accept at this time. For example:</P>
<!-- CODE SNIP //-->
<PRE>
&lt%@ language = &#147;java&#148; %&gt
</PRE>
<!-- END CODE SNIP //-->
<P><B>import</B>. Defines the list of packages that will be imported by the servlet. For example:</P>
<!-- CODE SNIP //-->
<PRE>
&lt%@ import = &#147;java.io.*, java.util.*, java.rmi.* %&gt
</PRE>
<!-- END CODE SNIP //-->
<P>A JSP can also use the tag &lt%= ... %&gt to print Java expressions. This is similar to the &ltjava type=print&gt tag for JHTML. The &lt% %&gt tag is valid inside another tag, so you don&#146;t need to use the backquotes. For example:
</P>
<!-- CODE SNIP //-->
<PRE>
&ltA HREF=&#148;/unzip/&lt%= curEntry.getName() %&gt&gt
</PRE>
<!-- END CODE SNIP //-->
<P>is a valid tag for a JSP.
</P>
<P>The following example JSP takes a query string that includes the name of a Zip archive in the Web server&#146;s root document directory or a subdirectory. This page opens the file and displays a table containing information about each entry. The names of the entries are links to a servlet, provided on the CD-ROM, that extract an entry from the Zip archive and return it to the client. Access to the archive is managed with the java.util.zip package, and a NumberFormat object is used to format the sizes for files that may be large. When run, this page looks like the one in Figure 10.11.</P>
<P><A NAME="Fig11"></A><A HREF="javascript:displayWindow('images/10-11.jpg',516,483 )"><IMG SRC="images/10-11t.jpg"></A>
<BR><A HREF="javascript:displayWindow('images/10-11.jpg',516,483)"><FONT COLOR="#000077"><B>Figure 10.11</B></FONT></A>&nbsp;&nbsp;zipreader.jsp.</P>
<P>The Java code in this example is in boldface type; the HTML is left plain.
</P>
<!-- CODE //-->
<PRE>
<B>&lt%@ import = &#147;java.util.zip.*,java.util.*,java.text.*&#148; %&gt

&lt%
  String zipFileName;
    String fullZipFileName;
        ZipFile zipFile;
       Enumeration entries;
   NumberFormat formatter;

       zipFileName = request.getQueryString();
        fullZipFileName = getServletContext().getRealPath(zipFileName);
        formatter = NumberFormat.getNumberInstance();

 try
    {
              zipFile = new ZipFile(fullZipFileName);
                entries = zipFile.entries();
   }
      catch(Exception exp)
   {
              zipFile = null;
                entries = null;
        }
 %&gt</B>

&ltHTML&gt
&ltHEAD&gt
&ltTITLE&gt
<B>&lt%= zipFileName %&gt</B>
&lt/TITLE&gt
&lt/HEAD&gt
&ltBODY&gt

&ltCENTER&gt
&ltTABLE WIDTH=500&gt

<B>&lt%
 if((zipFile == null)||(entries==null))
 {
%&gt</B>

&ltH2&gtNo Zip file specified.&lt/H2&gt

<B>&lt%
       }
      else if(!entries.hasMoreElements())
    {
%&gt</B>

&ltH2&gtThat Zip file contains no elements.&lt/H2&gt

<B>&lt%
  }
      else
   {
              ZipEntry curEntry;
%&gt</B>

&ltH1&gt<B>&lt%= zipFileName %&gt</B>&lt/H1&gt

&ltCENTER&gt
&ltTABLE WIDTH=450 BORDER=1 CELLSPACING=2&gt
&ltTR&gt
&ltTH&gtName&lt/TH&gt
&ltTH&gtActual (kB)&lt/TH&gt
&ltTH&gtCompressed (kB)&lt/TH&gt
&ltTH&gtMod Time&lt/TH&gt
&ltTH&gtComment&lt/TH&gt
&lt/TR&gt

<B>&lt%               
               while(entries.hasMoreElements())
               {
                      curEntry = (ZipEntry) entries.nextElement();            
%&gt</B>

&ltTR&gt
&ltTD&gt
&ltA HREF=&#147;/unzip/<B>&lt%= curEntry.getName() %&gt</B>?zipFile=<B>&lt%= zipFileName %&gt</B>&#148;&gt
<B>&lt%= curEntry.getName() %&gt</B>
&lt/A&gt
&lt/TD&gt
&ltTD&gt<B>&lt%= formatter.format(curEntry.getSize()/1024) %&gt</B>&lt/TD&gt
&ltTD&gt<B>&lt%= formatter.format(curEntry.getCompressedSize()/1024) %&gt</B>&lt/TD&gt
&ltTD&gt<B>&lt%= curEntry.getComment() %&gt</B>&lt/TD&gt
&lt/TR&gt
<B>&lt%
               }
%&gt</B>
&lt/TABLE&gt
&lt/CENTER&gt
<B>&lt%
        }
%&gt</B>
&lt/TABLE&gt
&lt/CENTER&gt

&lt/BODY&gt
&ltHTML&gt
</PRE>
<!-- END CODE //-->
<P>The UnZipServlet used in this example must be installed on the Web server under the name unzip for this page to work. You should also set up a servlet alias that forwards all requests that start with the path /unzip to the unzip servlet. To understand why the alias was used, let&#146;s consider the case where you extract an HTML file from the Zip archive. This HTML page may have links to other files in the archive. The browser treats these relative links correctly and passes them to the server using the alias as a directory. This means that if you extract an HTML page from the archive and click on a relative link to another page in the archive, the link is valid and the new page returned. Also, all of the images on a page that come from the archive are also valid. We strongly suggest trying this example or the JHTML equivalent. It is a great tool and a powerful addition to any Web site that wants to store information in archived format.
</P>
<P>The new JSP standard will also provide strong support for including and accessing JavaBeans within a JSP. By using bean&#146;s a JSP can leverage existing components and classes. This syntax and others will be defined in the product&#146;s final release. Please refer to java.sun.com/products/jsp for the latest information on JavaServer Pages.</P>
<H3><A NAME="Heading15"></A><FONT COLOR="#000077">Summary</FONT></H3>
<P>JavaServer Pages are a great middle ground between pure Java servlets and static HTML pages. They create an excellent combination of the two by using a simple tag mechanism for inserting Java code into an HTML page. Perhaps the most important thing to remember about JSPs is that the code inside the standard &ltjava&gt and &lt/java&gt tags will appear verbatim inside a generated servlet&#146;s service method. Variable declarations, loops, and everything will be included. The HTML for a page is displayed using byte/character oriented input/output (i/o) and appears in the service method as i/o calls.
</P>
<P>Server pages are designed for use in situations where the developer wants to leverage existing HTML created by a page designer rather than hard coding it into a servlet. However, JavaServer Pages are not meant to be used as static pages. They are for use only when dynamic data is required. As with servlets, you should use Java code only to create a response for the client if it is needed.</P>
<BLOCKQUOTE>
<P><FONT SIZE="-1"><HR><B>WARNING:&nbsp;&nbsp;</B>Some versions of the Java Web Server contain a bug that allows clients to get a JSP as is. This means that they see the Java source code rather than results from the generated servlet. Be careful about including information in the Java code that you don&#146;t want the user to access. Because the .jhtml file is on the server, this bug or as yet undiscovered ones could be used to access any information you include.</FONT><HR>
</BLOCKQUOTE>
<P>The next chapter examines a complete JSP application that implements a small online store. The example shows you what a complete implementation could look like.
</P><P><BR></P>
<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="10-07.html">Previous</A></TD>
<TD><A HREF="../ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="../ch11/11-01.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


<!-- 