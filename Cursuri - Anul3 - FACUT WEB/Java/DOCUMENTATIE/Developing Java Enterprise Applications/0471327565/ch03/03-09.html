
<SCRIPT>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
	',height=' + height + ',resizable=1,scrollbars=yes');
	}
	//-->
	</SCRIPT>



<FONT FACE="Arial,Helvetica" SIZE="-1">
To access the contents, click the chapter and section titles.
</FONT>
<P>
<B>Developing Java Enterprise Applications</B>
<FONT SIZE="-1">
<BR>
<I>(Publisher: John Wiley & Sons, Inc.)</I>
<BR>
Author(s): Stephen Asbury ; Scott R. Weiner
<BR>
ISBN: 0471327565
<BR>
Publication Date: 02/01/99
</FONT>
<P>
<Script language="JavaScript">
function isIE4() 
{
    return( navigator.appName.indexOf("Microsoft") != -1 && (navigator.appVersion.charAt(0)=='4') );
 }
function bookMarkit()
{
        var url="http://www.itknowledge.com/PSUser/EWBookMarks.html?url="+window.location+"&isbn=0";
	parent.location.href=url;
        //var win = window.open(url,"myitk");
        //if(!isIE4())
        //       win.focus();

}
</Script>
<a href="javascript:bookMarkit();"><img src="/images/bookmarkit.gif" border=0 alt="Bookmark It" width=97 height=23></a>

<P>
<form name="Search" method="GET" action="http://search.earthweb.com/search97/search_redir.cgi">

<INPUT TYPE="hidden" NAME="Action" VALUE="Search">
<INPUT TYPE="hidden" NAME="SearchPage" VALUE="http://search.earthweb.com/search97/samples/forms/srchdemo.htm">
<INPUT TYPE="hidden" NAME="Collection" VALUE="ITK">
<INPUT TYPE="hidden" NAME="ResultTemplate" VALUE="itk-simple-intrabook.hts">
<INPUT TYPE="hidden" NAME="ViewTemplate" VALUE="view.hts">

<font face="arial, helvetica" size=2><b>Search this book:</b></font><br>
<INPUT NAME="queryText" size=50 VALUE="">&nbsp;<input type="submit" name="submitbutton" value="Go!">
<INPUT type=hidden NAME="section_on" VALUE="on">
<INPUT type=hidden NAME="section" VALUE="http://www.itknowledge.com/reference/standard/0471327565/">

</form>


<!-- Empty Reference Subhead -->

<!--ISBN=0471327565//-->
<!--TITLE=Developing Java Enterprise Applications//-->
<!--AUTHOR=Stephen Asbury//-->
<!--AUTHOR=Scott R. Weiner//-->
<!--PUBLISHER=Wiley Computer Publishing//-->
<!--CHAPTER=03//-->
<!--PAGES=043-047//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="03-08.html">Previous</A></TD>
<TD><A HREF="../ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="03-10.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<P><BR></P>
<P>This example fetches all BEVERAGE products and their associated suppliers as well as the prices charged for the product, then prints this list, sorted by product. The ResultSet rs is returned with its cursor set before the first record. This is convenient for starting a while loop with rs.next().The first time through, the cursor is on the first record. Inside the loop, the values for the associated row columns are referenced by name. Use the getInt() method for the price. We didn&#146;t mind losing some data for our simple display purposes. You could have used getFloat() or getDouble() and then formatted the output.
</P>
<P><A NAME="Fig11"></A><A HREF="javascript:displayWindow('images/03-11.jpg',640,255 )"><IMG SRC="images/03-11t.jpg"></A>
<BR><A HREF="javascript:displayWindow('images/03-11.jpg',640,255)"><FONT COLOR="#000077"><B>Figure 3.11</B></FONT></A>&nbsp;&nbsp;ResultSetExample output.</P>
<!-- CODE //-->
<PRE>
import java.sql.*;

public class ResultSetExample
{
    public static void main (String args[])
    {
        try
        {
            Class.forName(&#147;sun.jdbc.odbc.JdbcOdbcDriver&#148;);
        } catch (Exception e)
        {
            System.out.println(&#147;JDBC&#150;ODBC driver failed to load.&#148;);
            return;
        }
  
        try
        {  
            Connection con =
              DriverManager.getConnection(
                                          &#147;jdbc:odbc:Inventory&#148;,
                                          &#147;&#148;,&#147;&#148;);
          
            Statement stmt = con.createStatement();
  
<B>            // Execute a query and retrieve ResultSet.
            ResultSet rs = stmt.executeQuery(&#147;SELECT SupplierName,&#148; &#43;
                                &#147; ProductName, Price &#148; &#43;
                                &#147;FROM ProductSuppliersView &#148; &#43;
                                &#147;WHERE CategoryName &#148; &#43;
                                &#147;LIKE &#145;%BEVERAGES%&#146; &#148; &#43;
                                &#147;ORDER BY ProductName&#148;);</B>

<B>            /*
               Now iterate through ResultSet and print the values
               of each attribute in the row. ResultSet maintains a
               cursor pointing to its current row of data. Initially, 
               the cursor is positioned before the first row. The
               next method moves the cursor to the next row.
            */</B>
            <B>while(rs.next()) </B>
            {   
                String supplier = rs.getString(&#147;SupplierName&#148;);
                String product = rs.getString(&#147;ProductName&#148;);
<B>                //ResultSet has methods to map values to Java types.
                 int price = rs.getInt(&#147;Price&#148;);</B>
      
                System.out.println(supplier &#43; &#147; sells &#148; &#43; product &#43;
                                   &#147; for $&#148; &#43; price);
            }

            stmt.close();
            con.close();
        } catch (Exception e)
        {
            System.out.println(e);
        }
    }
}
</PRE>
<!-- END CODE //-->
<P>The results of a query are returned in a result set. ResultSet stores the results in rows and maintains a pointer to the current row. Each value within a row can be accessed by its name or by its position. For example, instead of the line:
</P>
<!-- CODE SNIP //-->
<PRE>
int price = rs.getInt(&#147;Price&#148;);
</PRE>
<!-- END CODE SNIP //-->
<P>the following could have been used:
</P>
<!-- CODE SNIP //-->
<PRE>
int price = rs.getInt(3);
</PRE>
<!-- END CODE SNIP //-->
<P>This works only because we know that Price is the third column in the preceding query. You could also find this out by looking at the metadata of ResultSet. The next section explores the ResultSetMetaData class.
</P>
<H4 ALIGN="LEFT"><A NAME="Heading13"></A><FONT COLOR="#000077">Working with ResultSetMetaData</FONT></H4>
<P>In the previous example, the query was hard coded, so using the column names was a reasonable choice for fetching the data. However, what happens when you don&#146;t know the column names before accessing ResultSet? Each ResultSet can return an object that implements the ResultSetMetaData interface. This object contains information about the returned results, including the number of columns returned and the names and types of the columns. This information can be used to dynamically display values. Table 3.11 lists the ResultSetMetaData values.
</P>
<P>In this next example, the user is asked to type in SQL SELECT statements. The program will dynamically make requests against the database and display the results. The program will continue until the user types the word &#147;exit.&#148; In this example, only SQL statements that begin with the word SELECT are executed. This example could easily be extended to handle any SQL calls.</P>
<TABLE WIDTH="80%"><TD CAPTION VALIGN="TOP" ALIGN="LEFT" COLSPAN="3"><B>Table 3.11</B> ResultSetMetaData Methods
<TR>
<TD COLSPAN="3"><HR>
<TR>
<TH WIDTH="35%" VALIGN="TOP" ALIGN="LEFT">TYPE AND METHOD
<TH WIDTH="25%" VALIGN="TOP" ALIGN="LEFT">USE
<TR>
<TD COLSPAN="3"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT">String <B>getCatalogName</B>(int column)
<TD VALIGN="TOP" ALIGN="LEFT">Returns a column&#146;s table catalog name.
<TR>
<TD COLSPAN="3"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT">int <B>getColumnCount</B>()
<TD VALIGN="TOP" ALIGN="LEFT">Returns the number of columns in ResultSet.
<TR>
<TD COLSPAN="3"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT">int <B>getColumnDisplaySize</B>(int column)
<TD VALIGN="TOP" ALIGN="LEFT">Returns the column&#146;s preferred maximum width in characters.
<TR>
<TD COLSPAN="3"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT">String <B>getColumnLabel</B>(int column)
<TD VALIGN="TOP" ALIGN="LEFT">Returns the suggested column title for displaying the column.
<TR>
<TD COLSPAN="3"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT">String <B>getColumnName</B>(int column)
<TD VALIGN="TOP" ALIGN="LEFT">Returns a column&#146;s name.
<TR>
<TD COLSPAN="3"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT">int <B>getColumnType</B>(int column)
<TD VALIGN="TOP" ALIGN="LEFT">Returns a column&#146;s SQL type.
<TR>
<TD COLSPAN="3"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT">String <B>getColumnTypeName</B>(int column)
<TD VALIGN="TOP" ALIGN="LEFT">Returns a column&#146;s data source&#150;specific type name.
<TR>
<TD COLSPAN="3"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT">int <B>getPrecision</B>(int column)
<TD VALIGN="TOP" ALIGN="LEFT">Returns a column&#146;s number of decimal digits.
<TR>
<TD COLSPAN="3"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT">int <B>getScale</B>(int column)
<TD VALIGN="TOP" ALIGN="LEFT">Returns a column&#146;s number of digits to right of the decimal point.
<TR>
<TD COLSPAN="3"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT">String <B>getSchemaName</B>(int column)
<TD VALIGN="TOP" ALIGN="LEFT">Returns the name of a column&#146;s table&#146;s schema.
<TR>
<TD COLSPAN="3"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT">String <B>getTableName</B>(int column)
<TD VALIGN="TOP" ALIGN="LEFT">Returns a column&#146;s table name.
<TR>
<TD COLSPAN="3"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT">boolean <B>isAutoIncrement</B>(int column)
<TD VALIGN="TOP" ALIGN="LEFT">Returns whether this field is automatically generated. If it is automatically generated, it should be considered a read&#150;only set of values.
<TR>
<TD COLSPAN="3"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT">boolean <B>isCaseSensitive</B>(int column)
<TD VALIGN="TOP" ALIGN="LEFT">Returns true if the column&#146;s case matters to the data source.
<TR>
<TD COLSPAN="3"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT">boolean <B>isCurrency</B>(int column)
<TD VALIGN="TOP" ALIGN="LEFT">Returns whether the column is a monetary value.
<TR>
<TD COLSPAN="3"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT">boolean <B>isDefinitelyWritable</B>(int column)
<TD VALIGN="TOP" ALIGN="LEFT">Returns whether a write on the column definitely will succeed.
<TR>
<TD COLSPAN="3"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT">int <B>isNullable</B>(int column)
<TD VALIGN="TOP" ALIGN="LEFT">Returns true if you can put a NULL in this column.
<TR>
<TD COLSPAN="3"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT">boolean <B>isReadOnly</B>(int column)
<TD VALIGN="TOP" ALIGN="LEFT">Returns true if the column definitely is not writable.
<TR>
<TD COLSPAN="3"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT">boolean <B>isSearchable</B>(int column)
<TD VALIGN="TOP" ALIGN="LEFT">Returns true if the column can be used in a WHERE clause.
<TR>
<TD COLSPAN="3"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT">boolean <B>isSigned</B>(int column)
<TD VALIGN="TOP" ALIGN="LEFT">Returns true if the column represents a signed number.
<TR>
<TD COLSPAN="3"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT">boolean <B>isWritable</B>(int column)
<TD VALIGN="TOP" ALIGN="LEFT">Returns true if it is at least possible for a write on the column to succeed.
<TR>
<TD COLSPAN="3"><HR>
</TABLE>
<P><BR></P>
<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="03-08.html">Previous</A></TD>
<TD><A HREF="../ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="03-10.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


<!-- 