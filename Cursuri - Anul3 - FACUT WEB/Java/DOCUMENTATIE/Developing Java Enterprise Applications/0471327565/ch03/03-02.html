
<SCRIPT>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
	',height=' + height + ',resizable=1,scrollbars=yes');
	}
	//-->
	</SCRIPT>



<FONT FACE="Arial,Helvetica" SIZE="-1">
To access the contents, click the chapter and section titles.
</FONT>
<P>
<B>Developing Java Enterprise Applications</B>
<FONT SIZE="-1">
<BR>
<I>(Publisher: John Wiley & Sons, Inc.)</I>
<BR>
Author(s): Stephen Asbury ; Scott R. Weiner
<BR>
ISBN: 0471327565
<BR>
Publication Date: 02/01/99
</FONT>
<P>
<Script language="JavaScript">
function isIE4() 
{
    return( navigator.appName.indexOf("Microsoft") != -1 && (navigator.appVersion.charAt(0)=='4') );
 }
function bookMarkit()
{
        var url="http://www.itknowledge.com/PSUser/EWBookMarks.html?url="+window.location+"&isbn=0";
	parent.location.href=url;
        //var win = window.open(url,"myitk");
        //if(!isIE4())
        //       win.focus();

}
</Script>
<a href="javascript:bookMarkit();"><img src="/images/bookmarkit.gif" border=0 alt="Bookmark It" width=97 height=23></a>

<P>
<form name="Search" method="GET" action="http://search.earthweb.com/search97/search_redir.cgi">

<INPUT TYPE="hidden" NAME="Action" VALUE="Search">
<INPUT TYPE="hidden" NAME="SearchPage" VALUE="http://search.earthweb.com/search97/samples/forms/srchdemo.htm">
<INPUT TYPE="hidden" NAME="Collection" VALUE="ITK">
<INPUT TYPE="hidden" NAME="ResultTemplate" VALUE="itk-simple-intrabook.hts">
<INPUT TYPE="hidden" NAME="ViewTemplate" VALUE="view.hts">

<font face="arial, helvetica" size=2><b>Search this book:</b></font><br>
<INPUT NAME="queryText" size=50 VALUE="">&nbsp;<input type="submit" name="submitbutton" value="Go!">
<INPUT type=hidden NAME="section_on" VALUE="on">
<INPUT type=hidden NAME="section" VALUE="http://www.itknowledge.com/reference/standard/0471327565/">

</form>


<!-- Empty Reference Subhead -->

<!--ISBN=0471327565//-->
<!--TITLE=Developing Java Enterprise Applications//-->
<!--AUTHOR=Stephen Asbury//-->
<!--AUTHOR=Scott R. Weiner//-->
<!--PUBLISHER=Wiley Computer Publishing//-->
<!--CHAPTER=03//-->
<!--PAGES=019-022//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="03-01.html">Previous</A></TD>
<TD><A HREF="../ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="03-03.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<P><BR></P>
<P>
</P>
<TABLE WIDTH="80%"><TD CAPTION VALIGN="TOP" ALIGN="LEFT" COLSPAN="3"><B>Table 3.4</B> ProductSupplier Schema
<TR>
<TD COLSPAN="3"><HR>
<TR>
<TH WIDTH="25%" VALIGN="TOP" ALIGN="LEFT">FIELD
<TH WIDTH="25%" VALIGN="TOP" ALIGN="LEFT">TYPE
<TH WIDTH="25%" VALIGN="TOP" ALIGN="LEFT">NOTES
<TR>
<TD COLSPAN="3"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT">SupplierID
<TD VALIGN="TOP" ALIGN="LEFT">Number (integer)
<TD VALIGN="TOP" ALIGN="LEFT">Primary key
<TR>
<TD COLSPAN="3"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT">ProductID
<TD VALIGN="TOP" ALIGN="LEFT">Number (integer)
<TD VALIGN="TOP" ALIGN="LEFT">Foreign key
<TR>
<TD COLSPAN="3"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT">Price
<TD VALIGN="TOP" ALIGN="LEFT">Currency
<TD VALIGN="TOP" ALIGN="LEFT">
<TR>
<TD COLSPAN="3"><HR>
</TABLE>
<H3><A NAME="Heading3"></A><FONT COLOR="#000077">JDBC Basics</FONT></H3>
<P>The process for accessing a database using JDBC is fairly straightforward. This section describes the steps necessary to create a connection to a data source and then access it.
</P>
<P>The first step in any enterprise project is to determine the environment in which the project will be deployed. For example, are you writing an applet, an application, servlets, or enterprise JavaBeans? If JDBC is part of the project, you will have a number of JDBC&#150;specific issues to decide. The main configuration issues you need to determine will be:</P>
<DL>
<DD><B>Which database should you choose?</B> You might need to consider database&#150;specific issues, such as how to map custom data types to Java.
<P><A NAME="Fig1"></A><A HREF="javascript:displayWindow('images/03-01.jpg',640,278 )"><IMG SRC="images/03-01t.jpg"></A>
<BR><A HREF="javascript:displayWindow('images/03-01.jpg',640,278)"><FONT COLOR="#000077"><B>Figure 3.1</B></FONT></A>&nbsp;&nbsp;INV database schema.</P>
<DD><B>Which driver should you choose?</B> There may be more than one driver available for a given data source. Knowing the benefits of each driver will help you determine which is right for your application. For example, if you choose the ODBC driver, you have more flexibility as to which data source you connect to; however, if you choose a driver specifically designed for Oracle, it may be more efficient for accessing an Oracle database.
<DD><B>Where will the driver be located?</B> Depending on where you locate the driver, you may have performance considerations. For example, if you load the driver from a remote server, you&#146;ll need to handle standard Java security issues.
</DL>
<P>Regardless of the configuration you choose, the steps for accessing and interacting with the data source are almost identical. First, load a JDBC driver. A JDBC driver should implement the java.sql.Driver interface. When a driver class is loaded, it should create an instance of itself and register it with the DriverManager. This means that a user can load and register a driver by calling Class.forName(&#147;package.DriverName&#148;). Table A.3 in Appendix A contains a partial list of the drivers currently available. The list is maintained on the Sun Web site at <A HREF="www.javasoft.com/products/jdbc/jdbc.drivers.html">www.javasoft.com/products/jdbc/jdbc.drivers.html</A>.</P>
<BLOCKQUOTE>
<P><FONT SIZE="-1"><HR><B>NOTE:&nbsp;&nbsp;</B>When loading a driver, you must consider certain security issues. For example, if you have an applet in a Web browser that loads a driver over the network, you need to make sure the applet is from a trusted source. For more information on this subject, check out<BR><A HREF="java.sun.com/products/jdk/1.2/docs/ guide/jdbc/spec/jdbc&#150;spec.frame5.html">java.sun.com/products/jdk/1.2/docs/ guide/jdbc/spec/jdbc&#150;spec.frame5.html</A>.
</FONT><HR>
</BLOCKQUOTE>
<P>Next, create a connection to the data source. Create a URL that describes your data source and call the getConnection() method of the DriverManager. This method searches all the available drivers, looking for one that understands the URL passed in. Once the method finds one that can handle your data source, it returns a connection to that data source, as shown in Figure 3.2.
</P>
<P><A NAME="Fig2"></A><A HREF="javascript:displayWindow('images/03-02.jpg',500,330 )"><IMG SRC="images/03-02t.jpg"></A>
<BR><A HREF="javascript:displayWindow('images/03-02.jpg',500,330)"><FONT COLOR="#000077"><B>Figure 3.2</B></FONT></A>&nbsp;&nbsp;Selecting a driver.</P>
<P>If necessary, query the Connection for meta&#150;data about the database structure. The meta&#150;data is returned from the Connections&#146; method getMetaData in an object implementing the interface DatabaseMetaData. This interface contains a large number of methods. The DatabaseMetaData methods are described in detail in Appendix A, &#147;JDBC Information.&#148; The metadata is useful for figuring out unique features of a data source, such as a data source&#146;s ability to use the GROUP BY clause or whether the database supports transactions.
</P>
<P>Once you have your connection, create a SQL statement from that connection. To create a statement, call the Connections method createStatement(). This returns an object implementing the Statement interface. Use this Statement object to execute the query that uses the statement. The Statement object can be used to execute a SQL query by calling one of the methods listed in Table 3.5.</P>
<BLOCKQUOTE>
<P><FONT SIZE="-1"><HR><B>NOTE:&nbsp;&nbsp;</B>JDBC 2.0 adds the method int[] executeBatch(), which can be used to submit a batch of commands to the database for execution. This method returns an array of update counts for each statement executed.</FONT><HR>
</BLOCKQUOTE>
<P>Once a statement is executed, check for any problems with the query by calling getWarnings(). This returns an instance of the SQLWarning class.
</P>
<P>If no warnings occurred or if you can ignore the warnings, process the results from the query. Call getResults() to access ResultSet. Use this object to access all the return values.</P>
<P>Finally, close the database connection. Database connections are usually a limited resource for a database, so close the connection when you are finished.</P>
<TABLE WIDTH="75%"><TD CAPTION VALIGN="TOP" ALIGN="LEFT" COLSPAN="3"><B>Table 3.5</B> Execute Methods of the Statement Interface
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TH WIDTH="45%" VALIGN="TOP" ALIGN="LEFT">METHOD
<TH WIDTH="30%" VALIGN="TOP" ALIGN="LEFT">FUNCTION
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>boolean execute(String sql)</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">Execute a SQL statement that may return multiple result sets. This usually occurs when you call a stored procedure that returns non&#150;rectangular data. The method returns true if the next result from this statement will be a result table.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>ResultSet executeQuery(String sql)</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">Execute a SQL statement that returns a single result set. A result set is an interface that represents a set of data returned from a query.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>int executeUpdate(String sql)</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">Execute a SQL INSERT, UPDATE, or DELETE statement. It returns a the number of affected rows.
<TR>
<TD COLSPAN="2"><HR>
</TABLE>
<P>This is the complete process for accessing a data source with JDBC. The next section looks at the source code for a simple example that demonstrates all of these steps. You can compile and run the version on your CD&#150;ROM; the example is located in the Chapter 3 directory.
</P>
<H3><A NAME="Heading4"></A><FONT COLOR="#000077">A Simple JDBC Example</FONT></H3>
<P>This small example shows the steps to connect, query, and print the results of a database call. To keep the example simple, little error checking is done. A Microsoft Access database called INV.mdb is used as the data source; it is available on the CD&#150;ROM. The URL for the data source in this example is jdbc:odbc:inventory.
</P>
<BLOCKQUOTE>
<P><FONT SIZE="-1"><HR><B>NOTE:&nbsp;&nbsp;</B>You must have the JDBC driver that you are using in your class path. For example, this example uses the sun.jdbc.odbc.JdbcOdbcDriver.</FONT><HR>
</BLOCKQUOTE>
<P><BR></P><P><BR></P>
<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="03-01.html">Previous</A></TD>
<TD><A HREF="../ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="03-03.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


<!-- 