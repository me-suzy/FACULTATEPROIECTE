
<SCRIPT>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
	',height=' + height + ',resizable=1,scrollbars=yes');
	}
	//-->
	</SCRIPT>



<FONT FACE="Arial,Helvetica" SIZE="-1">
To access the contents, click the chapter and section titles.
</FONT>
<P>
<B>Developing Java Enterprise Applications</B>
<FONT SIZE="-1">
<BR>
<I>(Publisher: John Wiley & Sons, Inc.)</I>
<BR>
Author(s): Stephen Asbury ; Scott R. Weiner
<BR>
ISBN: 0471327565
<BR>
Publication Date: 02/01/99
</FONT>
<P>
<Script language="JavaScript">
function isIE4() 
{
    return( navigator.appName.indexOf("Microsoft") != -1 && (navigator.appVersion.charAt(0)=='4') );
 }
function bookMarkit()
{
        var url="http://www.itknowledge.com/PSUser/EWBookMarks.html?url="+window.location+"&isbn=0";
	parent.location.href=url;
        //var win = window.open(url,"myitk");
        //if(!isIE4())
        //       win.focus();

}
</Script>
<a href="javascript:bookMarkit();"><img src="/images/bookmarkit.gif" border=0 alt="Bookmark It" width=97 height=23></a>

<P>
<form name="Search" method="GET" action="http://search.earthweb.com/search97/search_redir.cgi">

<INPUT TYPE="hidden" NAME="Action" VALUE="Search">
<INPUT TYPE="hidden" NAME="SearchPage" VALUE="http://search.earthweb.com/search97/samples/forms/srchdemo.htm">
<INPUT TYPE="hidden" NAME="Collection" VALUE="ITK">
<INPUT TYPE="hidden" NAME="ResultTemplate" VALUE="itk-simple-intrabook.hts">
<INPUT TYPE="hidden" NAME="ViewTemplate" VALUE="view.hts">

<font face="arial, helvetica" size=2><b>Search this book:</b></font><br>
<INPUT NAME="queryText" size=50 VALUE="">&nbsp;<input type="submit" name="submitbutton" value="Go!">
<INPUT type=hidden NAME="section_on" VALUE="on">
<INPUT type=hidden NAME="section" VALUE="http://www.itknowledge.com/reference/standard/0471327565/">

</form>


<!-- Empty Reference Subhead -->

<!--ISBN=0471327565//-->
<!--TITLE=Developing Java Enterprise Applications//-->
<!--AUTHOR=Stephen Asbury//-->
<!--AUTHOR=Scott R. Weiner//-->
<!--PUBLISHER=Wiley Computer Publishing//-->
<!--CHAPTER=16//-->
<!--PAGES=445-448//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="16-14.html">Previous</A></TD>
<TD><A HREF="../ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="16-16.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<P><BR></P>
<P>The following example prints the metadata from the IsPrime example:
</P>
<!-- CODE //-->
<PRE>
package metaclient;

import javax.ejb.*;
import javax.naming.*;
import java.rmi.*;
import java.util.*;
import java.io.*;

import isprime.*;

public class MetaClient
{
    public static void main(String[] args)
    {
        Context ctx=null;

        try
        {
            ctx = getInitialContext(args);

            <B>IsPrimeHome home = (IsPrimeHome)
                         ctx.lookup(&#147;isprime.IsPrimeHome&#148;);
            IsPrime bean = home.create();
            EJBMetaData data = home.getEJBMetaData();</B>

            System.out.println(&#147;HomeInterfaceClass: &#148;
                     &#43;<B>data.getHomeInterfaceClass().</B>getName());

            System.out.println(&#147;RemoteInterfaceClass: &#148;
                      &#43;<B>data.getRemoteInterfaceClass().</B>getName());

            System.out.println(&#147;Session Bean: &#148;
                         &#43;(<B>data.isSession()</B>?&#147;true&#148;:&#147;false&#148;));

            if(<B>bean.getPrimaryKey()</B> != null)
            {
                System.out.println(&#147;PrimaryKeyClass: &#148;
                              &#43;data.getPrimaryKeyClass().getName());
            }

            home.remove(bean.getHandle());
        }
        catch (Exception e)
        {
            System.out.println(&#147;Error.&#148;);
            e.printStackTrace();
        }
        finally
        {
            try
            {
                ctx.close();
            }
            catch(Exception exp)
            {
        }
     }
    }
    static public Context getInitialContext(String[] args)
     throws Exception
    {
        //commented out to save space, see the CD-ROM
    }
}
</PRE>
<!-- END CODE //-->
<P>Basically, beans are simple objects and don&#146;t have a lot of associated metadata. However, this information can be useful to tools that need to determine information about a bean at run time. In particular, this metadata provides access to the bean&#146;s home and remote interface class names that might be needed for testing or development tools.
</P>
<TABLE WIDTH="100%"><TD CAPTION ALIGN="LEFT" COLSPAN="2"><B>Table 16.8</B> EJB Exception Classes
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TH WIDTH="30%" VALIGN="TOP" ALIGN="LEFT">CLASS
<TH VALIGN="TOP" ALIGN="LEFT">USAGE
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>CreateException</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">Indicates a failure during a create method. All create methods must declare that they can throw this type of exception.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>DuplicateKeyException</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">The requested object cannot be created, because an object with the same key already exists.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>EJBException</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">Generic exception that can be used to wrap other exceptions. For example, you could create an EJBException from a NullPointerException.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>FinderException</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">An object with the requested information could not be found. All find methods must declare that they can throw this type of exception.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>ObjectNotFoundException</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">Used by find methods that return a single EJB to indicate that the object could not be found. This is a subclass of FinderException.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>RemoveException</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">The request to remove a bean failed.
<TR>
<TD COLSPAN="2"><HR>
<TR>
</TABLE>
<P>As you may have noticed, the Enterprise JavaBeans specification defines a number of exception classes. These are summarized in Table 16.8.
</P>
<P>Many of these exceptions are targeted at specific bean life-cycle messages, such as the CreateException and the create methods. Beans can also use custom exceptions to notify callers of a problem. These custom exceptions should be serializable so that they can be transported to the client.</P>
<P>Both session and entity beans support the concept of handles. A handle is an object that implements the javax.ejb.Handle interface. This handle is a serializable object that contains the information necessary to contact the bean. Another client for the container-managed cart discussed earlier, called HandlingCartClient, is provided on the CD-ROM. This client demonstrates how a bean&#146;s handle can be serialized to disk, then unserialized and used to recontact an enterprise bean. These handles might be used by client applications that need to save their relationship with an EJB to disk.</P>
<P>The relevant code from the HandlingCartClient example to save a bean to disk is as follows:</P>
<!-- CODE //-->
<PRE>
try
{
     fileOut = new FileOutputStream(testFile);
     objOut = new ObjectOutputStream(fileOut);

     handle = cart.getHandle();

     objOut.writeObject(handle);

     objOut.close();
}
catch(Exception exp)
{
     exp.printStackTrace();
     cart = null;
}
</PRE>
<!-- END CODE //-->
<P>To restore the bean connection, the following code is used:
</P>
<!-- CODE //-->
<PRE>
try
{
     fileIn = new FileInputStream(testFile);
     objIn = new ObjectInputStream(fileIn);

     <B>handle = (Handle) objIn.readObject();</B>

     objIn.close();

     <B>cart = (ShoppingCart) handle.getEJBObject();</B>
     System.out.println(&#147;Created cart from handle: &#148;
                                           &#43;cart);
}
catch(Exception exp)
{
     cart = null;
     exp.printStackTrace();
}
</PRE>
<!-- END CODE //-->
<P>Unfortunately, there is a problem with serializing the handles provided with our version of the BEA WebLogic server, so this example is not completely tested. However, the specification does state that handles are serializable and can be used for this purpose, and we expect future versions of Tengah to support this technique.
</P><P><BR></P>
<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="16-14.html">Previous</A></TD>
<TD><A HREF="../ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="16-16.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


<!-- 