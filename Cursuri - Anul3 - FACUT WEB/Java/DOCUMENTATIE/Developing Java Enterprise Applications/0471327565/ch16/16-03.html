
<SCRIPT>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
	',height=' + height + ',resizable=1,scrollbars=yes');
	}
	//-->
	</SCRIPT>



<FONT FACE="Arial,Helvetica" SIZE="-1">
To access the contents, click the chapter and section titles.
</FONT>
<P>
<B>Developing Java Enterprise Applications</B>
<FONT SIZE="-1">
<BR>
<I>(Publisher: John Wiley & Sons, Inc.)</I>
<BR>
Author(s): Stephen Asbury ; Scott R. Weiner
<BR>
ISBN: 0471327565
<BR>
Publication Date: 02/01/99
</FONT>
<P>
<Script language="JavaScript">
function isIE4() 
{
    return( navigator.appName.indexOf("Microsoft") != -1 && (navigator.appVersion.charAt(0)=='4') );
 }
function bookMarkit()
{
        var url="http://www.itknowledge.com/PSUser/EWBookMarks.html?url="+window.location+"&isbn=0";
	parent.location.href=url;
        //var win = window.open(url,"myitk");
        //if(!isIE4())
        //       win.focus();

}
</Script>
<a href="javascript:bookMarkit();"><img src="/images/bookmarkit.gif" border=0 alt="Bookmark It" width=97 height=23></a>

<P>
<form name="Search" method="GET" action="http://search.earthweb.com/search97/search_redir.cgi">

<INPUT TYPE="hidden" NAME="Action" VALUE="Search">
<INPUT TYPE="hidden" NAME="SearchPage" VALUE="http://search.earthweb.com/search97/samples/forms/srchdemo.htm">
<INPUT TYPE="hidden" NAME="Collection" VALUE="ITK">
<INPUT TYPE="hidden" NAME="ResultTemplate" VALUE="itk-simple-intrabook.hts">
<INPUT TYPE="hidden" NAME="ViewTemplate" VALUE="view.hts">

<font face="arial, helvetica" size=2><b>Search this book:</b></font><br>
<INPUT NAME="queryText" size=50 VALUE="">&nbsp;<input type="submit" name="submitbutton" value="Go!">
<INPUT type=hidden NAME="section_on" VALUE="on">
<INPUT type=hidden NAME="section" VALUE="http://www.itknowledge.com/reference/standard/0471327565/">

</form>


<!-- Empty Reference Subhead -->

<!--ISBN=0471327565//-->
<!--TITLE=Developing Java Enterprise Applications//-->
<!--AUTHOR=Stephen Asbury//-->
<!--AUTHOR=Scott R. Weiner//-->
<!--PUBLISHER=Wiley Computer Publishing//-->
<!--CHAPTER=16//-->
<!--PAGES=398-401//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="16-02.html">Previous</A></TD>
<TD><A HREF="../ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="16-04.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<P><BR></P>
<P>In all cases, it is the host provider&#146;s responsibility to implement and document the container or containers they provide. The container used by a bean will probably be decided at deployment time, and the bean exists inside its container, oblivious to the implementation details that the container represents. There has been some discussion of users writing their own containers, but this is unlikely in the current specification because the host, container, and deployment tools will need to work very closely together.
</P>
<P>One of the tasks that the container and deployment tool collaborate on is to provide any code or libraries necessary for the client to access the Enterprise JavaBean. Recall that with RMI, it was the server programmer&#146;s job to create the stub and skeleton files used to access a remote object. In an EJB situation, the deployment tool creates these files, if it uses RMI, or any other files required by the communication protocol. For example, a CORBA-based host/container should create the IDL files required by the client to access the enterprise bean.</P>
<P>For the bean programmer, containers represent the construct in which a bean lives. A bean lives inside its own container. The type of container associated with the bean is based on its class and is determined by the deployment process. The container is the actual entity that provides the services discussed in the previous section. For example, it is the container that manages the bean&#146;s life cycle. However, although this is the container&#146;s responsibility and the word <I>container</I> implies that it somehow holds the enterprise bean, it is up to the container writer to actually define its implementation. The container could include a separate virtual machine, a Java object, or a thread inside an existing process. Certainly, the container will include access to the appropriate libraries, like JDBC, JTS, RMI, and so on. It is up to the container/host provider to decide the container&#146;s actual implementation. This is one of the areas that you should investigate when deciding on a EJB host provider.</P>
<P>In all cases, the container is transparent to the client. The client will interact with the bean&#146;s EJBHome and EJBObject, as pictured in Figure 16.1, but will not need to know how the container created these objects.</P>
<P><A NAME="Fig1"></A><A HREF="javascript:displayWindow('images/16-01.jpg',500,317 )"><IMG SRC="images/16-01t.jpg"></A>
<BR><A HREF="javascript:displayWindow('images/16-01.jpg',500,317)"><FONT COLOR="#000077"><B>Figure 16.1</B></FONT></A>&nbsp;&nbsp;EJB architecture.</P>
<H4 ALIGN="LEFT"><A NAME="Heading6"></A><FONT COLOR="#000077">Bean Context</FONT></H4>
<P>A bean&#146;s container provides an object called the EJB context to the bean for retrieving information from the container. This context object implements the javax.ejb.EJBContext interface, which defines a number of methods for accessing information. These methods are listed in Table 16.1. Most of these methods will seem cryptic at this point because they represent access to information that has not been used in this chapter. However, they are introduced here to give you a basic grasp of the division of work in the EJB specification.
</P>
<P>The one method that should be clear from the beginning is the getEnvironment method. This method returns a Properties object that provides key-value pairs defined in the bean&#146;s deployment/configuration. For example, you might use these environment properties to define the database, user name, and password for your bean.</P>
<P>Depending on the type of bean, session, or entity, the context provided is an extended version of EJBContext. In the case of a session bean, the context implements SessionContext, which provides the method:</P>
<!-- CODE SNIP //-->
<PRE>
public EJBObject getEJBObject() throws IllegalStateException
</PRE>
<!-- END CODE SNIP //-->
<P>You can use this method to access the EJBObject or distributed front end to your bean. One useful example of accessing this object is to pass your bean&#146;s id into a method or return it from a method.
</P>
<P>Entity beans are provided a context that implements javax.ejb.EntityContext. This interface includes the getEJBObject method as well as the method:</P>
<!-- CODE SNIP //-->
<PRE>
public Object getPrimaryKey() throws IllegalStateException
</PRE>
<!-- END CODE SNIP //-->
<P>Keeping in mind that entity beans represent actual data being stored somewhere, this method returns the primary key used to represent the entity bean. This primary key is managed by the EJB host, so the bean may want to access it for use in methods or as a return value.
</P>
<TABLE WIDTH="100%"><TD CAPTION ALIGN="LEFT" COLSPAN="2"><B>Table 16.1</B> EJBContext Methods
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TH WIDTH="40%" VALIGN="TOP" ALIGN="LEFT">METHOD
<TH VALIGN="TOP" ALIGN="LEFT">DESCRIPTION
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>public EJBHome getEJBHome()</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">Returns the EJBHome object associated with this bean.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>public Properties<BR>getEnvironment()</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">Returns the environment variables associated with this bean during deployment.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>public Identity<BR>getCallerIdentity()</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">Returns the Identity object associated with the bean based on the user&#146;s login or other security action.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>public boolean<BR>isCallerInRole(Identity role)</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">Checks whether the bean&#146;s identity is a member of a specified role. For example, is the bean being used by a Manager?
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>public UserTransaction<BR>getUserTransaction() throws<BR>IllegalStateException</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">Accesses the bean&#146;s transactions management infrastructure. This is discussed more in Chapter 23, &#147;Using Transactions with Enterprise JavaBeans,&#148; after the Java transaction APIs are introduced.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>public void setRollbackOnly()</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">Tells the context that this bean cannot commit its actions to any permanent store, possibly due to an unrecoverable error.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>public boolean getRollbackOnly()</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">Returns true if the context will support only rollbacks. Beans might use this method to make sure that the action they are about to perform will be able to commit or determine whether it is superfluous.
<TR>
<TD COLSPAN="2"><HR>
<TR>
</TABLE>
<P>Given this environment, context, and container that the EJB host provides, let&#146;s look at the steps to create an Enterprise JavaBean.
</P>
<H3><A NAME="Heading7"></A><FONT COLOR="#000077">Creating an Enterprise JavaBean</FONT></H3>
<P>Creating an enterprise JavaBean is a several-step process. This process is affected by the fact that EJBs are usually accessed over the network. This means that you will need to provide a small, concise interface to the bean&#146;s services. The process is also affected by the fact that the EJB specification takes into account multiple EJB host types. Finally, the EJB specification tries to make it easy for the bean developer to focus on the business logic that must be implemented rather than the infrastructure that the developer needs to rely on. In order for it to meet all of these goals, the specification uses several design patterns that separate the actual bean object from the client.
</P><P><BR></P>
<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="16-02.html">Previous</A></TD>
<TD><A HREF="../ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="16-04.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


<!-- 