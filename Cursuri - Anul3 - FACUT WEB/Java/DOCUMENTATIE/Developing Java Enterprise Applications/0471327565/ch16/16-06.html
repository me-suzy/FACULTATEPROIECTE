
<SCRIPT>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
	',height=' + height + ',resizable=1,scrollbars=yes');
	}
	//-->
	</SCRIPT>



<FONT FACE="Arial,Helvetica" SIZE="-1">
To access the contents, click the chapter and section titles.
</FONT>
<P>
<B>Developing Java Enterprise Applications</B>
<FONT SIZE="-1">
<BR>
<I>(Publisher: John Wiley & Sons, Inc.)</I>
<BR>
Author(s): Stephen Asbury ; Scott R. Weiner
<BR>
ISBN: 0471327565
<BR>
Publication Date: 02/01/99
</FONT>
<P>
<Script language="JavaScript">
function isIE4() 
{
    return( navigator.appName.indexOf("Microsoft") != -1 && (navigator.appVersion.charAt(0)=='4') );
 }
function bookMarkit()
{
        var url="http://www.itknowledge.com/PSUser/EWBookMarks.html?url="+window.location+"&isbn=0";
	parent.location.href=url;
        //var win = window.open(url,"myitk");
        //if(!isIE4())
        //       win.focus();

}
</Script>
<a href="javascript:bookMarkit();"><img src="/images/bookmarkit.gif" border=0 alt="Bookmark It" width=97 height=23></a>

<P>
<form name="Search" method="GET" action="http://search.earthweb.com/search97/search_redir.cgi">

<INPUT TYPE="hidden" NAME="Action" VALUE="Search">
<INPUT TYPE="hidden" NAME="SearchPage" VALUE="http://search.earthweb.com/search97/samples/forms/srchdemo.htm">
<INPUT TYPE="hidden" NAME="Collection" VALUE="ITK">
<INPUT TYPE="hidden" NAME="ResultTemplate" VALUE="itk-simple-intrabook.hts">
<INPUT TYPE="hidden" NAME="ViewTemplate" VALUE="view.hts">

<font face="arial, helvetica" size=2><b>Search this book:</b></font><br>
<INPUT NAME="queryText" size=50 VALUE="">&nbsp;<input type="submit" name="submitbutton" value="Go!">
<INPUT type=hidden NAME="section_on" VALUE="on">
<INPUT type=hidden NAME="section" VALUE="http://www.itknowledge.com/reference/standard/0471327565/">

</form>


<!-- Empty Reference Subhead -->

<!--ISBN=0471327565//-->
<!--TITLE=Developing Java Enterprise Applications//-->
<!--AUTHOR=Stephen Asbury//-->
<!--AUTHOR=Scott R. Weiner//-->
<!--PUBLISHER=Wiley Computer Publishing//-->
<!--CHAPTER=16//-->
<!--PAGES=407-409//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="16-05.html">Previous</A></TD>
<TD><A HREF="../ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="16-07.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<P><BR></P>
<P>In general, EJB developers should use the following programming rules:
</P>
<DL>
<DD><B>1.</B>&nbsp;&nbsp;Beans should not create threads or terminate running threads.
<DD><B>2.</B>&nbsp;&nbsp;Beans should not use mutable static variables. All static variables for EJBs should be marked as final for safety.
<DD><B>3.</B>&nbsp;&nbsp;Beans should not use thread synchronization primitives, because they may interfere with the host&#146;s thread management.
<DD><B>4.</B>&nbsp;&nbsp;Unless a bean specifically indicates that it will manage transactions, the bean should not perform any transaction management.
<DD><B>5.</B>&nbsp;&nbsp;Beans are assigned a security identity and should not attempt to change it.
<DD><B>6.</B>&nbsp;&nbsp;Beans that rely on the container for transaction management should not manage JDBC transactions; the container will perform this operation for them.
</DL>
<P>Programming enterprise beans is designed to be easier than programming a complete server by hand. The EJB host is expected to provide many services; as a result, it is necessary to write beans more simply than some server programmers may be accustomed to. For example, the threading issues for beans is primarily handled by the server, so the bean programmer can ignore these issues, even though in a totally handwritten program, the programmer would need to take threads into consideration. The bottom line is that beans should be written with their hosts&#146; services in mind; the programmer should not try to overimplement services that the host is already providing.
</P>
<H4 ALIGN="LEFT"><A NAME="Heading11"></A><FONT COLOR="#000077">Create Any Additional Classes You Need</FONT></H4>
<P>Often, your bean will access other beans or other code. This step is included for completeness in this discussion, but there really isn&#146;t anything to creating these classes that isn&#146;t part of writing any Java application. The one thing to keep in mind is that because enterprise beans are accessed on the network, they are subject to performance measures and stability requirements beyond most client applications. As a result, don&#146;t scrimp on the time you spend testing your supporting libraries&#151;they are a key part of the total application.
</P>
<H4 ALIGN="LEFT"><A NAME="Heading12"></A><FONT COLOR="#000077">Define Necessary Deployment Information</FONT></H4>
<P>Beans can have a number of configuration parameters set at deployment time. Most EJB hosts will provide a tool that allows you to define this information in an easy way. The final result of collecting this information will be a serialized object that the EJB host will load. This is discussed in more detail in Chapter 17.
</P>
<H4 ALIGN="LEFT"><A NAME="Heading13"></A><FONT COLOR="#000077">Compile the Bean</FONT></H4>
<P>Compiling the bean itself is the same as compiling any other Java code. Just be sure that you have access to the javax.ejb and javax.ejb.deployment packages as well as any other packages you use in the class path on the machine on which you compile the code.
</P>
<H4 ALIGN="LEFT"><A NAME="Heading14"></A><FONT COLOR="#000077">Package the Bean for Deployment</FONT></H4>
<P>The deployment information and a manifest file are packaged into a jar file for most EJB hosts. You may also package the bean itself into a jar file, although this depends on the host and its deployment tools. Chapter 17 discusses this step in detail. You may also want to read the documentation for your EJB host to determine its specific needs.
</P>
<P>The jar file in which the bean is deployed should contain all of the classes necessary to run the bean, including any supporting classes. Certainly, if you use the same libraries in multiple beans, the host may provide a mechanism for sharing classes.</P>
<H4 ALIGN="LEFT"><A NAME="Heading15"></A><FONT COLOR="#000077">Deploy the Bean</FONT></H4>
<P>Deploying a bean relies on tools specific to your host. In this step, the host creates the proxies for your remote interface and home interface. The tools also read the deployment information and possibly perform some configuration based on that information. The result of this step is a version of the bean and supporting material that the EJB host can load. Depending on the host, you may also have to tell the host to load the bean. For example, on BEA WebLogic&#146;s application server, deployment creates class files and a jar file containing the deployment information. You add a pointer to the deployment jar file in a properties file, and the server loads it.
</P>
<P>Given these general steps for creating an enterprise bean, let&#146;s look at the specific cases of creating a session bean and then an entity bean.</P>
<H3><A NAME="Heading16"></A><FONT COLOR="#000077">Creating a Session Bean</FONT></H3>
<P>As previously mentioned, session beans are used to perform operations, whereas entity beans are used to represent data or entities. Session beans fall into two categories: stateful and stateless. Stateful beans exist in a one-to-one relationship with the client. When a client creates a stateful session bean, it gets a bean that it can use without worrying about another bean taking its place, as long as the connection with the server is kept open or a handle to the bean is maintained. Stateless beans are more of a shared resource. The client can create stateless beans, but the server is not required to create the bean immediately, nor is it required to create a stateless bean for each client. Instead, stateless beans are shared as needed and determined by the EJB host.
</P>
<P>All of the requests to a session bean are organized into a single serial train of messages. This means that a session bean will not get two methods at the same time, nor should it get a message while it is performing a method. As a result of this message serialization, code cannot loop back to a session bean. For example, an account manager bean can call an account bean, but that account bean should not send a message to the manager as a result. At least, it should not send a message through the EJBObject. Keep in mind this key distinction. The EJB is usually accessed via the EJBObject that acts as a proxy. This access is serialized. Your library code could certainly directly access the bean, but because the EJB host is providing a number of services via the EJBObject, use it to access enterprise beans whenever possible, even if the beans are in the same application space.</P>
<P>In addition to the messages sent to a session bean from the client, the host notifies the session bean of various life-cycle information. This life cycle is summarized in Figure 16.2. This chapter uses a simple case in which the bean uses default transactions. Chapter 23 discusses how session beans can also receive notification of changes to their transaction state as well as the following messages. The actual timing for these events is different for stateful and stateless beans; each are discussed in detail below.</P>
<P>The creation of a session bean is broken into three steps. First, session beans are created using their classes newInstance method. This results in the default constructor being called.</P>
<P>Second, the bean is sent the message setSessionContext that tells it about its context. The argument to this method is a SessionContext object that implements the BeanContext interface discussed at the beginning of the chapter.</P>
<P>Third, the bean is sent one of its ejbCreate methods based on the client&#146;s request.</P>
<P><A NAME="Fig2"></A><A HREF="javascript:displayWindow('images/16-02.jpg',500,300 )"><IMG SRC="images/16-02t.jpg"></A>
<BR><A HREF="javascript:displayWindow('images/16-02.jpg',500,300)"><FONT COLOR="#000077"><B>Figure 16.2</B></FONT></A>&nbsp;&nbsp;Session bean life cycle.<P><BR></P>
<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="16-05.html">Previous</A></TD>
<TD><A HREF="../ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="16-07.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


<!-- 