
<SCRIPT>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
	',height=' + height + ',resizable=1,scrollbars=yes');
	}
	//-->
	</SCRIPT>



<FONT FACE="Arial,Helvetica" SIZE="-1">
To access the contents, click the chapter and section titles.
</FONT>
<P>
<B>Developing Java Enterprise Applications</B>
<FONT SIZE="-1">
<BR>
<I>(Publisher: John Wiley & Sons, Inc.)</I>
<BR>
Author(s): Stephen Asbury ; Scott R. Weiner
<BR>
ISBN: 0471327565
<BR>
Publication Date: 02/01/99
</FONT>
<P>
<Script language="JavaScript">
function isIE4() 
{
    return( navigator.appName.indexOf("Microsoft") != -1 && (navigator.appVersion.charAt(0)=='4') );
 }
function bookMarkit()
{
        var url="http://www.itknowledge.com/PSUser/EWBookMarks.html?url="+window.location+"&isbn=0";
	parent.location.href=url;
        //var win = window.open(url,"myitk");
        //if(!isIE4())
        //       win.focus();

}
</Script>
<a href="javascript:bookMarkit();"><img src="/images/bookmarkit.gif" border=0 alt="Bookmark It" width=97 height=23></a>

<P>
<form name="Search" method="GET" action="http://search.earthweb.com/search97/search_redir.cgi">

<INPUT TYPE="hidden" NAME="Action" VALUE="Search">
<INPUT TYPE="hidden" NAME="SearchPage" VALUE="http://search.earthweb.com/search97/samples/forms/srchdemo.htm">
<INPUT TYPE="hidden" NAME="Collection" VALUE="ITK">
<INPUT TYPE="hidden" NAME="ResultTemplate" VALUE="itk-simple-intrabook.hts">
<INPUT TYPE="hidden" NAME="ViewTemplate" VALUE="view.hts">

<font face="arial, helvetica" size=2><b>Search this book:</b></font><br>
<INPUT NAME="queryText" size=50 VALUE="">&nbsp;<input type="submit" name="submitbutton" value="Go!">
<INPUT type=hidden NAME="section_on" VALUE="on">
<INPUT type=hidden NAME="section" VALUE="http://www.itknowledge.com/reference/standard/0471327565/">

</form>


<!-- Empty Reference Subhead -->

<!--ISBN=0471327565//-->
<!--TITLE=Developing Java Enterprise Applications//-->
<!--AUTHOR=Stephen Asbury//-->
<!--AUTHOR=Scott R. Weiner//-->
<!--PUBLISHER=Wiley Computer Publishing//-->
<!--CHAPTER=20//-->
<!--PAGES=507-508//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="20-04.html">Previous</A></TD>
<TD><A HREF="../ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="20-06.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<P><BR></P>
<H4 ALIGN="LEFT"><A NAME="Heading10"></A><FONT COLOR="#000077">Message Producers</FONT></H4>
<P>In order to send a message, a client must ask the session to create a message producer for it. This message producer is an object that implements the MessageProducer interface. In fact, a client will create one of two subtypes of MessageProducer: TopicPublisher or QueueSender. Both of these provide specific methods for sending messages using their particular messaging styles. Both also provide the methods that they inherit from MessageProducer. These methods, described in Table 20.4, provide access to a set of default values for the message producer.
</P>
<TABLE WIDTH="100%"><TR>
<TD CAPTION ALIGN="LEFT" COLSPAN="2"><B>Table 20.4</B> Message Producer Methods
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TH VALIGN="TOP" WIDTH="50%" ALIGN="LEFT">METHOD
<TH VALIGN="TOP" ALIGN="LEFT">DESCRIPTION
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>public void setDisableMessageID(boolean value) throws JMSException</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">A JMS provider is expected to assign unique ids to each method. If the client doesn&#146;t need these ids, it can use this method to tell the provider that they are not required. This can save some resources; however, the provider may create them anyway for internal use.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>public boolean getDisableMessageID() throws JMSException</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">Returns whether or not message ids are disabled.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>public void setDisableMessageTimestamp(boolean value) throws JMSException</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">Like the message id, the provider is expected to time-stamp messages before they go through the messaging system. Because this increases message size, clients can hint that they want to disable this feature. However, like the message id, the provider may ignore this flag.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>public boolean getDisableMessageTimestamp() throws JMSExceptio</SMALL>n
<TD VALIGN="TOP" ALIGN="LEFT">Returns whether or not time stamps are disabled.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>public void setDeliveryMode(int deliveryMode) throws JMSException</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">Sets the default delivery mode for this producer. Messages will be sent with this mode unless otherwise specified. Possible values are javax.jms.DeliveryMode.PERSISTENT and javax.jms.DeliveryMode .NON_PERSISTENT. The default is persistent.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>public int getDeliveryMode() throws JMSException</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">Returns the producer&#146;s default delivery mode.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>public void setPriority(int deliveryMode) throws JMSException</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">Sets the default priority for a producer. Messages will be sent with this priority unless otherwise specified. The default is 4 on a scale from 0 to 9.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>public int getPriority() throws JMSException</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">Returns the producer&#146;s default priority.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>public void setTimeToLive(int timeToLive) throws JMSException</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">Sets the default time, in milliseconds, that the JMS provider should keep the message available. A value of 0 indicates that the message should not expire. This value is added to the time that a message is sent to determine its actual expiration date. The default is 0.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>public int getTimeToLive() throws JMSException</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">Returns the default time-to-live that the producer will use when sending messages.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>public void close() throws JMSException</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">Closes the producer and frees any resources.
<TR>
<TD COLSPAN="2"><HR>
</TABLE>
<P>In essence, the producer is storing default values to use when sending messages. These values are stored in the message itself, as discussed in the following section on message attributes. As with all of the objects in the JMS framework, you should close a producer when you finish using it in order to free any supporting resources.
</P>
<H4 ALIGN="LEFT"><A NAME="Heading11"></A><FONT COLOR="#000077">Message Consumers</FONT></H4>
<P>Message consumers are created by the session for clients that want to receive messages. Message consumers are attached to a Destination and are designed to retrieve messages sent to their destinations. These consumers must implement the MessageConsumer interface and, as in the producer case, actually implement a subtype of MessageConsumer. This subtype will be either QueueReceiver or TopicSubscriber. Unlike the MessageProducer interface, the majority of the interesting methods for a consumer are in the MessageConsumer interface itself. The subtypes provide only specific information about the destination that is being listened to.
</P>
<P>Clients have two options for retrieving messages from a consumer. First, the client can use one of the receive messages listed in Table 20.5. This is a synchronous mechanism that allows the client to keep message delivery in the thread of its choosing. Second, clients can register a message listener with the consumer. This listener will be notified of messages asynchronously but should always receive the onMessage message in the same thread. So, although the onMessage method will probably be called in a different thread from the one that initially created the consumer, it will not be called from a variety of threads and will not be called by more than one thread at a time. As discussed previously, the onMessage method should not throw any exceptions, because the JMS specification indicates that this method is safe for the provider to call.</P>
<TABLE WIDTH="100%"><TR>
<TD CAPTION ALIGN="LEFT" COLSPAN="2"><B>Table 20.5</B> Message Consumer Methods
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TH VALIGN="TOP" WIDTH="50%" ALIGN="LEFT">METHOD
<TH VALIGN="TOP" ALIGN="LEFT">DESCRIPTION
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>public String getMessageSelector() throws JMSException</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">Returns the consumer&#146;s message selector if one is assigned. Selectors are discussed in more detail in the &#147;Message Selectors&#148; section.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>public MessageListener getMessageListener() throws JMSException</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">Returns the consumer&#146;s message listener.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>public void setMessageListener(MessageListener listener) throws JMSException</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">Assigns the consumer&#146;s message listener. A consumer can have only one listener at a time.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>public Message receive() throws JMSException</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">Returns the next message for the consumer; this method will block and wait until a message arrives.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>public Message receive(long timeOut) throws JMSException</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">Returns the next message for the consumer; this method will block and wait until a message arrives or the time-out is reached. If the method times out, null is returned. The time-out is specified in milliseconds.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>public Message receiveNoWait() throws JMSException</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">Returns the next message for the consumer or null if one is not available. This method does not block.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>public void close() throws JMSException</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">Closes the consumer and frees resources.
<TR>
<TD COLSPAN="2"><HR>
</TABLE>
<P><BR></P>
<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="20-04.html">Previous</A></TD>
<TD><A HREF="../ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="20-06.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


<!-- 