
<SCRIPT>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
	',height=' + height + ',resizable=1,scrollbars=yes');
	}
	//-->
	</SCRIPT>



<FONT FACE="Arial,Helvetica" SIZE="-1">
To access the contents, click the chapter and section titles.
</FONT>
<P>
<B>Developing Java Enterprise Applications</B>
<FONT SIZE="-1">
<BR>
<I>(Publisher: John Wiley & Sons, Inc.)</I>
<BR>
Author(s): Stephen Asbury ; Scott R. Weiner
<BR>
ISBN: 0471327565
<BR>
Publication Date: 02/01/99
</FONT>
<P>
<Script language="JavaScript">
function isIE4() 
{
    return( navigator.appName.indexOf("Microsoft") != -1 && (navigator.appVersion.charAt(0)=='4') );
 }
function bookMarkit()
{
        var url="http://www.itknowledge.com/PSUser/EWBookMarks.html?url="+window.location+"&isbn=0";
	parent.location.href=url;
        //var win = window.open(url,"myitk");
        //if(!isIE4())
        //       win.focus();

}
</Script>
<a href="javascript:bookMarkit();"><img src="/images/bookmarkit.gif" border=0 alt="Bookmark It" width=97 height=23></a>

<P>
<form name="Search" method="GET" action="http://search.earthweb.com/search97/search_redir.cgi">

<INPUT TYPE="hidden" NAME="Action" VALUE="Search">
<INPUT TYPE="hidden" NAME="SearchPage" VALUE="http://search.earthweb.com/search97/samples/forms/srchdemo.htm">
<INPUT TYPE="hidden" NAME="Collection" VALUE="ITK">
<INPUT TYPE="hidden" NAME="ResultTemplate" VALUE="itk-simple-intrabook.hts">
<INPUT TYPE="hidden" NAME="ViewTemplate" VALUE="view.hts">

<font face="arial, helvetica" size=2><b>Search this book:</b></font><br>
<INPUT NAME="queryText" size=50 VALUE="">&nbsp;<input type="submit" name="submitbutton" value="Go!">
<INPUT type=hidden NAME="section_on" VALUE="on">
<INPUT type=hidden NAME="section" VALUE="http://www.itknowledge.com/reference/standard/0471327565/">

</form>


<!-- Empty Reference Subhead -->

<!--ISBN=0471327565//-->
<!--TITLE=Developing Java Enterprise Applications//-->
<!--AUTHOR=Stephen Asbury//-->
<!--AUTHOR=Scott R. Weiner//-->
<!--PUBLISHER=Wiley Computer Publishing//-->
<!--CHAPTER=13//-->
<!--PAGES=330-332//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="13-02.html">Previous</A></TD>
<TD><A HREF="../ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="13-04.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<P><BR></P>
<P>Implementing the remote interface requires that you create an object that extends the class java.rmi.server.RemoteObject. RemoteObject overrides many of the java.lang.Object methods to make them network aware. These methods include hashCode, toString, and equals. The stub received by the client will also extend RemoteObject appropriately.
</P>
<BLOCKQUOTE>
<P><FONT SIZE="-1"><HR><B>NOTE:&nbsp;&nbsp;</B>Java 2 may loosen the requirement that the interface between client and server extends Remote. Methods should also be able to declare that they throw the superclasses of RemoteException instead of having to throw RemoteExceptions. This would include Exception and IOException. All methods in the remote interface, whether it extends Remote or not, must declare that they can throw one of these three exception types.</FONT><HR>
</BLOCKQUOTE>
<P>Currently, the RMI implementation suggests that your initial server extend a subclass of RemoteObject. Two subclasses are provided for this purpose: UnicastRemoteObject and Activatable. Both of these classes are direct subclasses of RemoteServer, which extends RemoteObject.
</P>
<BLOCKQUOTE>
<P><FONT SIZE="-1"><HR><B>NOTE:&nbsp;&nbsp;</B>Some implementations of RMI may require that the server object implement UnicastRemoteObject. Read the latest documentation to determine if this restriction applies to your application.</FONT><HR>
</BLOCKQUOTE>
<P>RemoteServer defines three static methods that all RMI server objects may find useful. First, the RemoteServer can return the host name of the client using this method:
</P>
<!-- CODE SNIP //-->
<PRE>
public static String getClientHost()
               throws ServerNotActiveException
</PRE>
<!-- END CODE SNIP //-->
<P>This method throws a ServerNotActiveException when called from a method not associated with a client request. Otherwise, the RemoteServer class uses information about the current thread to determine the client and its host name. The RemoteServer class also manages a stream that can be used for logging messages. The methods for managing this stream are as follows:
</P>
<!-- CODE SNIP //-->
<PRE>
public static void setLog(OutputStream out)
public static PrintStream getLog()
</PRE>
<!-- END CODE SNIP //-->
<P>Setting the log to null turns off any automatic logging.
</P>
<P>UnicastRemoteObject is the primary superclass for RMI server objects. Objects can also extend Activatable to indicate that they want to participate in the activation framework as discussed in the section &#147;Remote Object Activation.&#148; UnicastRemoteObject defines the basic semantics of being a server object and handling network accessibility. Constructors are provided as part of UnicastRemoteObject to control the networking code used by the RMI packages to support a server object. The default constructor uses an anonymous port and the default sockets factories to create network connections. Two other constructors, listed here, allow the programmer to configure these values:</P>
<!-- CODE SNIP //-->
<PRE>
protected UnicastRemoteObject(int port)
                 throws RemoteException;

protected UnicastRemoteObject(int port,
                     RMIClientSocketFactory csf,
                     RMIServerSocketFactory ssf)
                 throws RemoteException;
</PRE>
<!-- END CODE SNIP //-->
<P>All three constructors are marked protected so that only a subclass can call them. You cannot instantiate a UnicastRemoteObject directly. When the UnicastRemoteObject is created, it opens a network connection for receiving messages. This connection is managed by the RMI library code. The process by which an object is associated with a network connection is called <I>exporting</I>. Programs can export objects manually, without subclassing UnicastRemoteObject. The simplest method for exporting an object is as follows:</P>
<!-- CODE SNIP //-->
<PRE>
public static RemoteStub exportObject(Remote obj)
                   throws RemoteException
</PRE>
<!-- END CODE SNIP //-->
<P>Other methods are provided to allow the caller to configure the port and socket factories for the object&#146;s network connections. Any method that is expected to receive remote messages should be exported either directly or as part of the constructor it inherits from UnicastRemoteObject.
</P>
<P>Like the client, the server should use the RMISecurityManager; in Java 2, this may require a policy file. Also like the client, the server will have some RMI-specific exceptions to deal with. These are listed in Table 13.3.</P>
<P>RMI has the ability load classes over the network. If you try to communicate with an object for which you do not have the class in your virtual machine, RMI automatically loads the class, provided you have set up the correct system properties. A list of the server-related properties for RMI is included in Table 13.4. These properties can be set either inside a program or using the command line.</P>
<P>Perhaps the most important of these properties is the server code base. This value must be set if your program wants to send an object to a client when the object&#146;s class is not in the client&#146;s CLASSPATH. Keep in mind that this value must be set if any of the classes are not in the CLASSPATH. If the client and server are on the same computer, the code base can be a file URL. However, if the client and server are on different computers, a Web server is necessary to provide a host for the class files, and the URL should target this Web server.</P>
<TABLE WIDTH="100%"><TD CAPTION COLSPAN="2" ALIGN="LEFT"><B>Table 13.3</B> RMI Server Exceptions
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TH VALIGN="TOP" ALIGN="LEFT" WIDTH="35%">EXCEPTION CLASS
<TH VALIGN="TOP" ALIGN="LEFT" WIDTH="55%">MEANING
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT" WIDTH="35%"><SMALL>java.rmi.server.ExportException</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT" WIDTH="55%">An attempt to export an object failed.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT" WIDTH="35%"><SMALL>java.rmi.server.ServerCloneException</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT" WIDTH="55%">An exception occurred trying to clone a UnicastRemoteObject.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT" WIDTH="35%"><SMALL>java.rmi.server .ServerNotActiveException</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT" WIDTH="55%">The server tried to call getClientHost when not in a remote method.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT" WIDTH="35%"><SMALL>java.rmi.server.SkeletonMismatchException</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT" WIDTH="55%">Deprecated Exception, no longer used in Java 2. Indicates that a message was sent to the server that was not part of the remote interface, possibly caused by failing to run rmic to update the stub and skeleton files.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT" WIDTH="35%"><SMALL>java.rmi.server.SkeletonNotFoundException</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT" WIDTH="55%">Deprecated Exception, no longer used in Java 2. Indicates that the skeleton-class files for the server cannot be found.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT" WIDTH="35%"><SMALL>java.rmi.server.SocketSecurityException</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT" WIDTH="55%">The server does not have permission to create a server socket.
<TR>
<TD COLSPAN="2"><HR>
</TABLE>
<P><BR></P>
<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="13-02.html">Previous</A></TD>
<TD><A HREF="../ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="13-04.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


<!-- 