
<SCRIPT>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
	',height=' + height + ',resizable=1,scrollbars=yes');
	}
	//-->
	</SCRIPT>



<FONT FACE="Arial,Helvetica" SIZE="-1">
To access the contents, click the chapter and section titles.
</FONT>
<P>
<B>Developing Java Enterprise Applications</B>
<FONT SIZE="-1">
<BR>
<I>(Publisher: John Wiley & Sons, Inc.)</I>
<BR>
Author(s): Stephen Asbury ; Scott R. Weiner
<BR>
ISBN: 0471327565
<BR>
Publication Date: 02/01/99
</FONT>
<P>
<Script language="JavaScript">
function isIE4() 
{
    return( navigator.appName.indexOf("Microsoft") != -1 && (navigator.appVersion.charAt(0)=='4') );
 }
function bookMarkit()
{
        var url="http://www.itknowledge.com/PSUser/EWBookMarks.html?url="+window.location+"&isbn=0";
	parent.location.href=url;
        //var win = window.open(url,"myitk");
        //if(!isIE4())
        //       win.focus();

}
</Script>
<a href="javascript:bookMarkit();"><img src="/images/bookmarkit.gif" border=0 alt="Bookmark It" width=97 height=23></a>

<P>
<form name="Search" method="GET" action="http://search.earthweb.com/search97/search_redir.cgi">

<INPUT TYPE="hidden" NAME="Action" VALUE="Search">
<INPUT TYPE="hidden" NAME="SearchPage" VALUE="http://search.earthweb.com/search97/samples/forms/srchdemo.htm">
<INPUT TYPE="hidden" NAME="Collection" VALUE="ITK">
<INPUT TYPE="hidden" NAME="ResultTemplate" VALUE="itk-simple-intrabook.hts">
<INPUT TYPE="hidden" NAME="ViewTemplate" VALUE="view.hts">

<font face="arial, helvetica" size=2><b>Search this book:</b></font><br>
<INPUT NAME="queryText" size=50 VALUE="">&nbsp;<input type="submit" name="submitbutton" value="Go!">
<INPUT type=hidden NAME="section_on" VALUE="on">
<INPUT type=hidden NAME="section" VALUE="http://www.itknowledge.com/reference/standard/0471327565/">

</form>


<!-- Empty Reference Subhead -->

<!--ISBN=0471327565//-->
<!--TITLE=Developing Java Enterprise Applications//-->
<!--AUTHOR=Stephen Asbury//-->
<!--AUTHOR=Scott R. Weiner//-->
<!--PUBLISHER=Wiley Computer Publishing//-->
<!--CHAPTER=05//-->
<!--PAGES=079-082//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="../ch04/04-03.html">Previous</A></TD>
<TD><A HREF="../ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="05-02.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<P><BR></P>
<H2><A NAME="Heading1"></A><FONT COLOR="#000077">CHAPTER 5<BR>Using JNDI
</FONT></H2>
<P>This chapter covers the basic use of JNDI. The goal of this chapter is enable you to set up and create directory and naming service connections to access contexts via JNDI. This chapter discusses JNDI 1.1. For information on future versions of JNDI, browse the Sun Web site at <A HREF="http://java.sun.com/products/jndi">http://java.sun.com/products/jndi</A>.</P>
<P>JNDI provides a consistent model for accessing and manipulating enterprise resources such as the file system, CORBA, a directory service, or an application server, through Java. JNDI provides the additional benefit of allowing you to bind a Java object into these services. Figure 5.1 illustrates the JNDI architecture. At the top of the JNDI architecture is the Java application that wants to use JNDI. This application uses the javax.naming and javax.naming.directory packages to access JNDI services. The two client packages use the NamingManager, or DirectoryManager, to create the appropriate JNDI context for an application. A context represents a connection to a JNDI service provider. The code for a context is written by a JNDI service provider and implements the appropriate javax.naming.spi interfaces as well as the required interfaces from the client API. Ultimately, a service provider&#146;s implementation talks to a data source, like LDAP, the file system or the RMI registry. Most of these connections are hidden from the user behind a set of properties used to create the context.</P>
<P>This chapter focuses on the services available in the javax.naming and the javax.naming.directory packages. The service provider package is not discussed in detail because it will be used only by the few programmers creating JNDI service providers.</P>
<P><A NAME="Fig1"></A><A HREF="javascript:displayWindow('images/05-01.jpg',500,296 )"><IMG SRC="images/05-01t.jpg"></A>
<BR><A HREF="javascript:displayWindow('images/05-01.jpg',500,296)"><FONT COLOR="#000077"><B>Figure 5.1</B></FONT></A>&nbsp;&nbsp;JNDI architecture.</P>
<H3><A NAME="Heading2"></A><FONT COLOR="#000077">Setup Requirements</FONT></H3>
<P>In order to program with JNDI, you should have the following libraries accessible from your computer:
</P>
<DL>
<DD><B>&#149;</B>&nbsp;&nbsp;JDK 1.1.2 or higher.
<DD><B>&#149;</B>&nbsp;&nbsp;JNDI package&#151;your CLASSPATH should include jndi.jar; otherwise, the path to jndi.jar must be included on the command line for each example in this chapter.
<DD><B>&#149;</B>&nbsp;&nbsp;A service provider package for each service you access through JNDI.
</DL>
<P>You will need additional resources such as an LDAP server to use some of the later examples in this chapter. The CD-ROM contains the Java components you need to run the examples in this chapter; however, the final versions of the two service providers we have used were not released at publication time. To find a list of available providers and download the latest implementations provided by Sun, browse <A HREF="http://java.sun .com/products/jndi/serviceproviders.html">http://java.sun .com/products/jndi/serviceproviders.html</A>. In addition, an LDAP configuration file is used with this chapter. You don&#146;t have to use this configuration file. Using another configuration won&#146;t affect the effectiveness of the examples, but it will produce results that differ from the examples discussed in this chapter.</P>
<P>If you intend to use JNDI with other directory and naming services such as CORBA, you will require additional service provider packages. The service provider is created by implementing the interfaces in the javax.naming.spi package for the specific naming service. In order to use any provider, you must put it in your CLASSPATH. For example, to use the file system service provider, you must have fscontext.jar in your CLASSPATH. The jar fscontext.jar contains the implementation of the javax.naming.spi specifically for accessing the file system.</P>
<H4 ALIGN="LEFT"><A NAME="Heading3"></A><FONT COLOR="#000077">About the Sample Service Provider</FONT></H4>
<P>The service provider used for most of the examples in this chapter is the file system provider called FsContext. This provider allows you to access your file system as a set of file system context objects that represent directories and as file objects that represent the files in those directories. Because files are represented with java.io.File, this provider is platform independent and can be used to access the directory structure on any platform on which the Java application runs.
</P>
<P>FsContext provides naming services and associated names, file paths, with File objects. After the chapter explores the basic features of the naming services, it examines some of the advanced features of JNDI implemented by directory services, such as attribute manipulation and attribute queries. These features require the use of another provider. We chose the LDAP service provider. If you do not have LDAP, you should be able to follow along with the examples presented here and get an understanding of how directory services can be used.</P>
<BLOCKQUOTE>
<P><FONT SIZE="-1"><HR><B>NOTE:&nbsp;&nbsp;</B>If you do not have access to an LDAP server, you can download one from the University of Michigan Web site at <A HREF="www.umich.edu/~dirsvcs/ldap/ ldap.html">www.umich.edu/~dirsvcs/ldap/ ldap.html</A>.
</FONT><HR>
</BLOCKQUOTE>
<P>The goal of this chapter is to provide an overview of JNDI. Because the JNDI interface is consistent across all service providers, little time is spent on LDAP specific issues. Instead, the focus is on general use of JNDI. If you do have LDAP and choose to load the example configuration from your CD-ROM, you should have schema checking turned off for some of the later examples. We recommend turning it off because the schema we built is not necessarily self-consistent; it was designed for educational value and not production use.
</P>
<H3><A NAME="Heading4"></A><FONT COLOR="#000077">The Naming Package</FONT></H3>
<P>The naming package provides a set of classes and interfaces that are used to access any naming service for which you have a provider. Once you have a provider, you can perform the following functions using the naming package:
</P>
<DL>
<DD><B>&#149;</B>&nbsp;&nbsp;Access a context, including listing and searching
<DD><B>&#149;</B>&nbsp;&nbsp;Rename, move, add, replace, or remove a binding for an object
<DD><B>&#149;</B>&nbsp;&nbsp;Store references to Java objects
</DL>
<P>This section steps through the components of the javax.naming package necessary to perform the procedures listed above.
</P>
<H4 ALIGN="LEFT"><A NAME="Heading5"></A><FONT COLOR="#000077">Access a Context</FONT></H4>
<P>The javax.naming package defines the Context interface. A <I>context</I> represents a starting point for a naming or directory service. The file system context in the examples for this chapter uses the set of files and directories stored on the local file system as a context. Figure 5.2 shows the directory structure used for the examples in this chapter. Because this structure represents the context in which the following naming examples are written, you should familiarize yourself with it. The CD-ROM contains a script to build the sample directory structure if you want to run the provided examples.</P>
<P>Once created, an object implementing the Context interface represents the root for all naming operations performed. The initial context can be thought of as the root for your file path; however, it is not always the same as the root directory in your file system. For example, it could be a subdirectory in your file system. Figure 5.3 illustrates how the marketing directory could be the root for a context.</P>
<P>To create a Context object, perform the following steps:</P>
<DL>
<DD><B>1.</B>&nbsp;&nbsp;<B>Set up the environment.</B> JNDI uses a set of environment variables to tell it which service providers to access and how to initialize them. If you don&#146;t set one of these values, the System properties are used. Table 5.1 lists these properties. The simplest way to assign the environment is to load a property file as described for JDBC in Chapter 3, &#147;Basic JDBC Programming,&#148; or create a hash table containing the environment settings. There are many properties that can be used to create a new context; study Table 5.1 carefully. However, as demonstrated in the examples in this chapter, only a few of these properties are required. In particular, the initial factory and provider URL will normally be required to create a context.
<DD><B>2.</B>&nbsp;&nbsp;<B>Create an initial context.</B> JNDI requires that you have an initial context for all operations. This context is considered the root of your naming operations. For example, consider the directory structure in Figure 5.2. If an initial context is created at /, the path to report1.txt is /tmp/marketing/reports/report1.txt. However, if an initial context is created at /tmp/marketing/, the path is /reports/report1.txt.
</DL>
<P><A NAME="Fig2"></A><A HREF="javascript:displayWindow('images/05-02.jpg',477,420 )"><IMG SRC="images/05-02t.jpg"></A>
<BR><A HREF="javascript:displayWindow('images/05-02.jpg',477,420)"><FONT COLOR="#000077"><B>Figure 5.2</B></FONT></A>&nbsp;&nbsp;Example directory structure.<P><BR></P>
<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="../ch04/04-03.html">Previous</A></TD>
<TD><A HREF="../ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="05-02.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


<!-- 