
<SCRIPT>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
	',height=' + height + ',resizable=1,scrollbars=yes');
	}
	//-->
	</SCRIPT>



<FONT FACE="Arial,Helvetica" SIZE="-1">
To access the contents, click the chapter and section titles.
</FONT>
<P>
<B>Developing Java Enterprise Applications</B>
<FONT SIZE="-1">
<BR>
<I>(Publisher: John Wiley & Sons, Inc.)</I>
<BR>
Author(s): Stephen Asbury ; Scott R. Weiner
<BR>
ISBN: 0471327565
<BR>
Publication Date: 02/01/99
</FONT>
<P>
<Script language="JavaScript">
function isIE4() 
{
    return( navigator.appName.indexOf("Microsoft") != -1 && (navigator.appVersion.charAt(0)=='4') );
 }
function bookMarkit()
{
        var url="http://www.itknowledge.com/PSUser/EWBookMarks.html?url="+window.location+"&isbn=0";
	parent.location.href=url;
        //var win = window.open(url,"myitk");
        //if(!isIE4())
        //       win.focus();

}
</Script>
<a href="javascript:bookMarkit();"><img src="/images/bookmarkit.gif" border=0 alt="Bookmark It" width=97 height=23></a>

<P>
<form name="Search" method="GET" action="http://search.earthweb.com/search97/search_redir.cgi">

<INPUT TYPE="hidden" NAME="Action" VALUE="Search">
<INPUT TYPE="hidden" NAME="SearchPage" VALUE="http://search.earthweb.com/search97/samples/forms/srchdemo.htm">
<INPUT TYPE="hidden" NAME="Collection" VALUE="ITK">
<INPUT TYPE="hidden" NAME="ResultTemplate" VALUE="itk-simple-intrabook.hts">
<INPUT TYPE="hidden" NAME="ViewTemplate" VALUE="view.hts">

<font face="arial, helvetica" size=2><b>Search this book:</b></font><br>
<INPUT NAME="queryText" size=50 VALUE="">&nbsp;<input type="submit" name="submitbutton" value="Go!">
<INPUT type=hidden NAME="section_on" VALUE="on">
<INPUT type=hidden NAME="section" VALUE="http://www.itknowledge.com/reference/standard/0471327565/">

</form>


<!-- Empty Reference Subhead -->

<!--ISBN=0471327565//-->
<!--TITLE=Developing Java Enterprise Applications//-->
<!--AUTHOR=Stephen Asbury//-->
<!--AUTHOR=Scott R. Weiner//-->
<!--PUBLISHER=Wiley Computer Publishing//-->
<!--CHAPTER=05//-->
<!--PAGES=091-095//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="05-04.html">Previous</A></TD>
<TD><A HREF="../ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="05-06.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<P><BR></P>
<P><A NAME="Fig4"></A><A HREF="javascript:displayWindow('images/05-04.jpg',529,387 )"><IMG SRC="images/05-04t.jpg"></A>
<BR><A HREF="javascript:displayWindow('images/05-04.jpg',529,387)"><FONT COLOR="#000077"><B>Figure 5.4</B></FONT></A>&nbsp;&nbsp;Results of calling list() and listBindings().</P>
<!-- CODE //-->
<PRE>
import javax.naming.*;
import javax.naming.directory.*;
import java.util.Hashtable;
import java.util.Enumeration;
import java.io.*;

// example use: java Print

public class Print
{
public static void main(String[] args)
{
Hashtable env = new Hashtable();
        env.put(Context.INITIAL_CONTEXT_FACTORY,
&#147;com.sun.jndi.fscontext.RefFSContextFactory&#148;);

        env.put(Context.PROVIDER_URL,&#147;file:/tmp/marketing&#148;);

        try
        {
            Context initCtx = new InitialContext(env);

            <B>// We assume we are reading in a file.
            File f =(File)initCtx.lookup(&#147;reports/report1.txt&#148;);
</B>
            //Print the file located
            if(f != null)
            {
                BufferedReader br = 
new BufferedReader(new FileReader(f));
                String l = null;
                while((l = br.readLine()) != null)
                    System.out.println(l);
            }
        }
        catch(Exception e)
        {
            System.out.println(e);
            e.printStackTrace(System.out);
        }
    }
}
</PRE>
<!-- END CODE //-->
<P>The bold code above performs the lookup on the current context looking for reports/report1.txt. If the context had been / instead of /tmp/marketing, a lookup would have to explicitly be set to tmp/marketing/reports/report1.txt to perform the same lookup operation. All of these searching operations rely on the concept of object bindings, which we examine next.
</P>
<H4 ALIGN="LEFT"><A NAME="Heading6"></A><FONT COLOR="#000077">Object Bindings</FONT></H4>
<P>A <I>binding</I> is the name of an object, the name of the object&#146;s class, and the object itself. Context provides methods for manipulating these bindings. Table 5.5 lists these methods.</P>
<P>The examples in this section revolve around the fsContext service provider, but it is important to keep in mind that these same operations can be used for removing an object from a CORBA repository or adding personal contact information to an LDAP directory server. All the functions described in this section are useful with any provider. How that provider actually implements each function depends on the provider. The documentation on each provider will tell you how these functions work for that specific provider. For example, unbind deletes a file when using the file system provider, but with RMI it simply removes an object reference from the remote registry. Let&#146;s look at the unbind function first.</P>
<TABLE WIDTH="85%"><TD CAPTION COLSPAN="2"><B>Table 5.5</B> Binding-Related Methods of Context
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TH WIDTH="35%" VALIGN="TOP" ALIGN="LEFT">Method 
<TH WIDTH="50%" VALIGN="TOP" ALIGN="LEFT">Use
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>bind(Name, Object), bind(String, Object)</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">Binds the name to the object in the context. Throws an exception if the name is already in use.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>createSubcontext(Name), createSubcontext(String)</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">Creates and binds a new context to the name.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>destroySubcontext(Name), destroySubcontext(String)</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">Destroys the named context and removes it from the namespace. 
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>rebind(Name, Object), rebind(String, Object)</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">Binds the name to the object, overwriting any existing binding.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>rename(Name oldName, Name newName), rename(String oldName, String newName</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">Binds newName to the object bound to oldName and unbinds oldName.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>unbind(Name), unbind(String)</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT">Unbinds the named object from the namespace.
<TR>
<TD COLSPAN="2"><HR>
<TR>
</TABLE>
<P><FONT SIZE="+1"><B><I>Deleting an Object Binding</I></B></FONT></P>
<P>To delete report2.txt from the marketing reports directory, execute the command &#147;java Delete report2.txt&#148; to initiate the following code:
</P>
<!-- CODE //-->
<PRE>
import javax.naming.*;
import java.util.Hashtable;

// Deletes files from the marketing directory
// example use: java Delete filename

public class Delete
{
    public static void main(String[] args)
    {
        // Define a starting point for operation.
        <B>String initalContextString = &#147;/tmp/marketing/reports&#148;;</B>

        if(args.length &lt 1)
        {
            System.out.println(&#147;Usage: java Delete filename&#148;);
            System.exit(-1);
        }
        System.out.println(&#147;This program assumes the context is &#148; &#43; 
            initialContextString);

        <B>Hashtable env = new Hashtable();
  env.put(Context.INITIAL_CONTEXT_FACTORY,
&#147;com.sun.jndi.fscontext.RefFSContextFactory&#148;);
        env.put(Context.PROVIDER_URL,&#147;file:&#148; &#43; initalContextString);</B>


        try
        {
            <B>Context initCtx = new InitialContext(env);</B>

            // Delete file or other object...
            System.out.println(&#147;Attempting to unbind &#148; &#43; args[0]);

            <B>initCtx.unbind(args[0]);</B>

            System.out.println(&#147;Done.&#148;);
        }catch(NamingException e)
        {
            System.out.println(e);
            e.printStackTrace(System.out);
        }
    }
}
</PRE>
<!-- END CODE //-->
<P>The Delete program sets an initial context of /tmp/marketing/reports and requests that the user enter the name of a file to delete in that directory. The <I>unbind</I> method is called to unbind or delete the selected file. The initial context is set for safety as this program deletes files; we wouldn&#146;t want you to accidentally delete important files on your computer.</P>
<BLOCKQUOTE>
<P><FONT SIZE="-1"><HR><B>NOTE:&nbsp;&nbsp;</B>The fsContext provider will not delete directories, it will only delete files through the unbind method. Other providers may perform differently.</FONT><HR>
</BLOCKQUOTE>
<P><FONT SIZE="+1"><B><I>Renaming and Moving an Object</I></B></FONT></P>
<P>Using the rename method of a context allows you to change the name bound to the object. In the case of the file system provider, this is equivalent to changing the name of a file or directory. However, there is one difference: If the path to the named object differs from the path to the new name, the object is explicitly moved in the context. For example, if you rename /tmp/marketing to /tmp/products, the directory marketing will be renamed products. However, if you rename /tmp/marketing/reports/report1.txt to /tmp/report1.txt, the report1.txt file (object) will be moved into the subcontext /tmp. The program Rename in the code listed below takes two command line inputs: a file or directory name or path and the new path name. Try renaming/moving files and directories to get a feel for how this works.
</P><P><BR></P>
<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="05-04.html">Previous</A></TD>
<TD><A HREF="../ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="05-06.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


<!-- 